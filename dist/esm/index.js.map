{"version":3,"file":"index.js","sources":["../../../src/utils/drawingUtils.ts","../../../src/hooks/useSignature.ts","../../../src/hooks/useUndoRedo.ts","../../../src/components/SignatureControls.tsx","../../../src/components/SignatureCustomizationPanel.tsx","../../../src/components/SignaturePad.tsx","../../../src/utils/exportUtils.ts","../../../src/utils/validationUtils.ts"],"sourcesContent":["import { Point } from '../types';\n\nexport const drawCurve = (ctx: CanvasRenderingContext2D, points: Point[]): void => {\n  if (points.length < 3) {\n    const point = points[0];\n    ctx.lineTo(point.x, point.y);\n    ctx.stroke();\n    return;\n  }\n\n  ctx.beginPath();\n  ctx.moveTo(points[0].x, points[0].y);\n\n  for (let i = 1; i < points.length - 2; i++) {\n    const xc = (points[i].x + points[i + 1].x) / 2;\n    const yc = (points[i].y + points[i + 1].y) / 2;\n    ctx.quadraticCurveTo(points[i].x, points[i].y, xc, yc);\n  }\n\n  ctx.quadraticCurveTo(\n    points[points.length - 2].x,\n    points[points.length - 2].y,\n    points[points.length - 1].x,\n    points[points.length - 1].y\n  );\n\n  ctx.stroke();\n};\n\nexport const calculateVelocity = (points: Point[]): number => {\n  if (points.length < 2) return 0;\n\n  const lastPoint = points[points.length - 1];\n  const secondLastPoint = points[points.length - 2];\n  \n  const distance = Math.sqrt(\n    Math.pow(lastPoint.x - secondLastPoint.x, 2) + \n    Math.pow(lastPoint.y - secondLastPoint.y, 2)\n  );\n  \n  const timeDiff = lastPoint.time - secondLastPoint.time;\n  \n  return timeDiff > 0 ? distance / timeDiff : 0;\n};\n\nexport const getPressureBasedWidth = (\n  pressure: number, \n  minWidth: number, \n  maxWidth: number\n): number => {\n  return minWidth + (maxWidth - minWidth) * pressure;\n};\n\nexport const getVelocityBasedWidth = (\n  velocity: number, \n  baseWidth: number, \n  minWidth: number, \n  maxWidth: number\n): number => {\n  const newWidth = baseWidth - (velocity * baseWidth) / 5;\n  return Math.max(minWidth, Math.min(maxWidth, newWidth));\n};","import { useRef, useCallback, useEffect, useState } from 'react';\nimport { Point, SignatureOptions, DrawingMode, UseSignatureResult } from '../types';\nimport { drawCurve, calculateVelocity, getPressureBasedWidth, getVelocityBasedWidth } from '../utils/drawingUtils';\n\nexport const useSignature = (\n  canvasRef: React.RefObject<HTMLCanvasElement>, \n  options: Partial<SignatureOptions>\n): UseSignatureResult => {\n  const pointsRef = useRef<Point[]>([]);\n  const [isEmpty, setIsEmpty] = useState(true);\n  const [currentOptions, setCurrentOptions] = useState<SignatureOptions>({\n    width: options.width || 800,\n    height: options.height || 300,\n    penColor: options.penColor || '#000000',\n    penWidth: options.penWidth || 2,\n    backgroundColor: options.backgroundColor || '#ffffff',\n    drawingMode: options.drawingMode || 'pen',\n    minWidth: options.minWidth || 0.5,\n    maxWidth: options.maxWidth || 2.5,\n    velocityFilterWeight: options.velocityFilterWeight || 0.7,\n  });\n\n  // Update options when they change\n  useEffect(() => {\n    setCurrentOptions(prev => ({\n      ...prev,\n      ...options,\n      width: options.width || prev.width,\n      height: options.height || prev.height,\n    }));\n  }, [options]);\n\n  // Initialize canvas\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    \n    const ctx = canvas.getContext('2d');\n    if (!ctx) return;\n    \n    // Set initial styles\n    ctx.lineCap = 'round';\n    ctx.lineJoin = 'round';\n    ctx.fillStyle = currentOptions.backgroundColor;\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n    \n    setIsEmpty(true);\n  }, [canvasRef, currentOptions.backgroundColor]);\n\n  const draw = {\n    start: useCallback((event: MouseEvent | TouchEvent) => {\n      const canvas = canvasRef.current;\n      if (!canvas) return;\n      \n      const ctx = canvas.getContext('2d');\n      if (!ctx) return;\n      \n      const rect = canvas.getBoundingClientRect();\n      const clientX = 'touches' in event ? event.touches[0].clientX : event.clientX;\n      const clientY = 'touches' in event ? event.touches[0].clientY : event.clientY;\n      \n      const point: Point = {\n        x: clientX - rect.left,\n        y: clientY - rect.top,\n        time: Date.now(),\n        pressure: 'pressure' in event ? (event as any).pressure : 0.5\n      };\n      \n      pointsRef.current = [point];\n      setIsEmpty(false);\n      \n      ctx.beginPath();\n      ctx.moveTo(point.x, point.y);\n    }, [canvasRef]),\n    \n    move: useCallback((event: MouseEvent | TouchEvent) => {\n      if (pointsRef.current.length === 0) return;\n      \n      const canvas = canvasRef.current;\n      if (!canvas) return;\n      \n      const ctx = canvas.getContext('2d');\n      if (!ctx) return;\n      \n      const rect = canvas.getBoundingClientRect();\n      const clientX = 'touches' in event ? event.touches[0].clientX : event.clientX;\n      const clientY = 'touches' in event ? event.touches[0].clientY : event.clientY;\n      \n      const newPoint: Point = {\n        x: clientX - rect.left,\n        y: clientY - rect.top,\n        time: Date.now(),\n        pressure: 'pressure' in event ? (event as any).pressure : 0.5\n      };\n      \n      const points = pointsRef.current;\n      points.push(newPoint);\n      \n      // Calculate line width based on velocity or pressure\n      const velocity = calculateVelocity(points);\n      const baseWidth = currentOptions.penWidth;\n      \n      let width = baseWidth;\n      if (currentOptions.drawingMode === 'marker') {\n        width = Math.max(currentOptions.minWidth, baseWidth - (velocity * baseWidth) / 3);\n      } else if (currentOptions.drawingMode === 'highlighter') {\n        width = baseWidth + 2;\n        ctx.globalAlpha = 0.5;\n      } else {\n        width = Math.max(currentOptions.minWidth, Math.min(currentOptions.maxWidth, baseWidth - (velocity * baseWidth) / 5));\n      }\n      \n      ctx.lineWidth = width;\n      ctx.strokeStyle = currentOptions.penColor;\n      \n      // Draw smooth curve\n      drawCurve(ctx, points);\n      \n      // Reset alpha if using highlighter\n      if (currentOptions.drawingMode === 'highlighter') {\n        ctx.globalAlpha = 1;\n      }\n      \n      // Keep only recent points for performance\n      if (points.length > 5) {\n        pointsRef.current = points.slice(-5);\n      }\n    }, [canvasRef, currentOptions]),\n    \n    end: useCallback(() => {\n      pointsRef.current = [];\n    }, [])\n  };\n\n  const clear = useCallback(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    \n    const ctx = canvas.getContext('2d');\n    if (!ctx) return;\n    \n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    ctx.fillStyle = currentOptions.backgroundColor;\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n    \n    setIsEmpty(true);\n    pointsRef.current = [];\n  }, [canvasRef, currentOptions.backgroundColor]);\n\n  const toDataURL = useCallback((type?: string, quality?: number) => {\n    const canvas = canvasRef.current;\n    if (!canvas || isEmpty) return '';\n    return canvas.toDataURL(type, quality);\n  }, [canvasRef, isEmpty]);\n\n  const exportAsImage = useCallback((filename: string = 'signature') => {\n    const dataUrl = toDataURL('image/png');\n    if (!dataUrl) return;\n    \n    const link = document.createElement('a');\n    link.download = `${filename}.png`;\n    link.href = dataUrl;\n    link.click();\n  }, [toDataURL]);\n\n  const exportAsSVG = useCallback(() => {\n    // Implementation for SVG export\n    return ''; // Placeholder\n  }, []);\n\n  // Options setters\n  const setDrawingMode = useCallback((mode: DrawingMode) => {\n    setCurrentOptions(prev => ({ ...prev, drawingMode: mode }));\n  }, []);\n\n  const setPenColor = useCallback((color: string) => {\n    setCurrentOptions(prev => ({ ...prev, penColor: color }));\n  }, []);\n\n  const setPenWidth = useCallback((width: number) => {\n    setCurrentOptions(prev => ({ ...prev, penWidth: width }));\n  }, []);\n\n  const setBackgroundColor = useCallback((color: string) => {\n    setCurrentOptions(prev => ({ ...prev, backgroundColor: color }));\n    \n    // Redraw background if canvas exists\n    const canvas = canvasRef.current;\n    if (canvas) {\n      const ctx = canvas.getContext('2d');\n      if (ctx) {\n        ctx.fillStyle = color;\n        ctx.fillRect(0, 0, canvas.width, canvas.height);\n        \n        // Redraw signature if it exists\n        if (!isEmpty) {\n          const dataUrl = toDataURL('image/png');\n          if (dataUrl) {\n            const img = new Image();\n            img.onload = () => {\n              ctx.drawImage(img, 0, 0);\n            };\n            img.src = dataUrl;\n          }\n        }\n      }\n    }\n  }, [canvasRef, isEmpty, toDataURL]);\n\n  const setMinWidth = useCallback((width: number) => {\n    setCurrentOptions(prev => ({ ...prev, minWidth: width }));\n  }, []);\n\n  const setMaxWidth = useCallback((width: number) => {\n    setCurrentOptions(prev => ({ ...prev, maxWidth: width }));\n  }, []);\n\n  const setVelocityFilterWeight = useCallback((weight: number) => {\n    setCurrentOptions(prev => ({ ...prev, velocityFilterWeight: weight }));\n  }, []);\n\n  return {\n    isEmpty,\n    draw,\n    clear,\n    undo: () => {}, // Placeholder - would be implemented with useUndoRedo\n    redo: () => {}, // Placeholder\n    canUndo: false, // Placeholder\n    canRedo: false, // Placeholder\n    exportAsImage,\n    exportAsSVG,\n    toDataURL,\n    setDrawingMode,\n    setPenColor,\n    setPenWidth,\n    setBackgroundColor,\n    setMinWidth,\n    setMaxWidth,\n    setVelocityFilterWeight,\n    currentOptions\n  };\n};","import { useState, useCallback } from 'react';\nimport { UseUndoRedoResult } from '../types';\n\nexport const useUndoRedo = (getCurrentState: () => string): UseUndoRedoResult => {\n  const [history, setHistory] = useState<string[]>([]);\n  const [future, setFuture] = useState<string[]>([]);\n  const [maxHistorySize] = useState(50);\n\n  const addState = useCallback((state: string) => {\n    setHistory(prev => {\n      const newHistory = [...prev, state];\n      // Limit history size\n      return newHistory.slice(-maxHistorySize);\n    });\n    setFuture([]); // Clear future when adding a new state\n  }, [maxHistorySize]);\n\n  const undo = useCallback((): string | undefined => {\n    if (history.length === 0) return undefined;\n    \n    const previousState = history[history.length - 1];\n    const currentState = getCurrentState();\n    \n    setHistory(prev => prev.slice(0, -1));\n    setFuture(prev => [currentState, ...prev]);\n    \n    return previousState;\n  }, [history, getCurrentState]);\n\n  const redo = useCallback((): string | undefined => {\n    if (future.length === 0) return undefined;\n    \n    const nextState = future[0];\n    \n    setHistory(prev => [...prev, getCurrentState()]);\n    setFuture(prev => prev.slice(1));\n    \n    return nextState;\n  }, [future, getCurrentState]);\n\n  const clearHistory = useCallback((): void => {\n    setHistory([]);\n    setFuture([]);\n  }, []);\n\n  return {\n    addState,\n    undo,\n    redo,\n    canUndo: history.length > 0,\n    canRedo: future.length > 0,\n    clearHistory\n  };\n};","\nimport * as React from 'react';\nimport { SignatureControlsProps, DrawingMode } from '../types';\n\ninterface EnhancedSignatureControlsProps extends SignatureControlsProps {\n  onDownload?: () => void;\n  onResetPen?: () => void;\n  showGrid?: boolean;\n  onToggleGrid?: () => void;\n  showEraser?: boolean;\n  onEraserMode?: () => void;\n  theme?: 'default' | 'tailwind';\n}\n\nconst SignatureControls: React.FC<EnhancedSignatureControlsProps> = ({\n  onUndo,\n  onRedo,\n  onClear,\n  onSave,\n  onUpload,\n  onDrawingModeChange,\n  onPenColorChange,\n  onPenWidthChange,\n  canUndo,\n  canRedo,\n  isEmpty,\n  currentOptions,\n  saveText = 'Save',\n  uploadText = 'Upload',\n  clearText = 'Clear',\n  onDownload,\n  onResetPen,\n  showGrid = false,\n  onToggleGrid,\n  showEraser = false,\n  onEraserMode,\n  theme = 'default'\n}: EnhancedSignatureControlsProps) => {\n  const btnCls = theme === 'tailwind'\n    ? 'sig-pad-toolbar-btn'\n    : 'control-button';\n  const containerCls = theme === 'tailwind'\n    ? 'signature-controls flex flex-wrap gap-2 mb-2'\n    : 'signature-controls';\n  return (\n    <div className={containerCls} role=\"toolbar\" aria-label=\"Signature controls\">\n      <div className=\"controls-left flex items-center gap-2 flex-wrap\">\n        <button \n          onClick={onUndo} \n          disabled={!canUndo}\n          className={btnCls}\n          title=\"Undo\"\n          aria-label=\"Undo\"\n        >\n          ↶\n        </button>\n        <button \n          onClick={onRedo} \n          disabled={!canRedo}\n          className={btnCls}\n          title=\"Redo\"\n          aria-label=\"Redo\"\n        >\n          ↷\n        </button>\n        <select \n          value={currentOptions.drawingMode} \n          onChange={(e: React.ChangeEvent<HTMLSelectElement>) => onDrawingModeChange(e.target.value as DrawingMode)}\n          className={theme === 'tailwind' ? 'control-select h-8 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-sm px-2' : 'control-select'}\n          aria-label=\"Drawing mode\"\n        >\n          <option value=\"pen\">Pen</option>\n          <option value=\"marker\">Marker</option>\n          <option value=\"highlighter\">Highlighter</option>\n          {showEraser && <option value=\"eraser\">Eraser</option>}\n        </select>\n        <input \n          type=\"color\" \n          value={currentOptions.penColor} \n          onChange={(e: React.ChangeEvent<HTMLInputElement>) => onPenColorChange(e.target.value)}\n          className={theme === 'tailwind' ? 'control-color h-8 w-10 border border-gray-300 dark:border-gray-600 rounded-md overflow-hidden' : 'control-color'}\n          title=\"Pen Color\"\n          aria-label=\"Pen color\"\n        />\n        <input \n          type=\"range\" \n          min=\"1\" \n          max=\"10\" \n          value={currentOptions.penWidth} \n          onChange={(e: React.ChangeEvent<HTMLInputElement>) => onPenWidthChange(parseInt(e.target.value))}\n          className={theme === 'tailwind' ? 'control-slider cursor-pointer accent-brand-600' : 'control-slider'}\n          title=\"Pen Width\"\n          aria-label=\"Pen width\"\n        />\n        <span className=\"pen-width-label\" aria-label=\"Pen width value\">{currentOptions.penWidth}px</span>\n        {onResetPen && (\n          <button \n            onClick={onResetPen}\n            className={btnCls}\n            title=\"Reset Pen Settings\"\n            aria-label=\"Reset pen settings\"\n          >\n            Reset\n          </button>\n        )}\n        {showEraser && onEraserMode && (\n          <button \n            onClick={onEraserMode}\n            className={btnCls}\n            title=\"Eraser Mode\"\n            aria-label=\"Eraser mode\"\n          >\n            Eraser\n          </button>\n        )}\n        {onToggleGrid && (\n          <button \n            onClick={onToggleGrid}\n            className={btnCls}\n            title={showGrid ? \"Hide Grid\" : \"Show Grid\"}\n            aria-label={showGrid ? \"Hide grid\" : \"Show grid\"}\n          >\n            {showGrid ? \"Hide Grid\" : \"Show Grid\"}\n          </button>\n        )}\n      </div>\n      <div className=\"controls-right flex items-center gap-2 flex-wrap\">\n        <button \n          onClick={onClear} \n          className={`${btnCls} clear-button`}\n          title={clearText}\n          aria-label=\"Clear signature\"\n        >\n          {clearText}\n        </button>\n        {onSave && (\n          <button \n            onClick={onSave} \n            disabled={isEmpty}\n            className={`${btnCls} save-button`}\n            title={saveText}\n            aria-label=\"Save signature\"\n          >\n            {saveText}\n          </button>\n        )}\n        {onUpload && (\n          <button \n            onClick={onUpload} \n            disabled={isEmpty}\n            className={`${btnCls} upload-button`}\n            title={uploadText}\n            aria-label=\"Upload signature\"\n          >\n            {uploadText}\n          </button>\n        )}\n        {onDownload && (\n          <button \n            onClick={onDownload}\n            disabled={isEmpty}\n            className={btnCls}\n            title=\"Download signature\"\n            aria-label=\"Download signature\"\n          >\n            Download\n          </button>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default SignatureControls;","import React from 'react';\nimport { SignatureOptions, DrawingMode } from '../types';\n\ninterface SignatureCustomizationPanelProps {\n  options: Partial<SignatureOptions>;\n  onOptionsChange: (options: Partial<SignatureOptions>) => void;\n  onClose: () => void;\n}\n\nconst SignatureCustomizationPanel: React.FC<SignatureCustomizationPanelProps> = ({\n  options,\n  onOptionsChange,\n  onClose\n}) => {\n  const handleChange = (key: keyof SignatureOptions, value: any) => {\n    onOptionsChange({ [key]: value });\n  };\n\n  return (\n    <div className=\"signature-customization-panel\">\n      <div className=\"panel-header\">\n        <h3>Customize Signature</h3>\n        <button onClick={onClose} className=\"close-button\">×</button>\n      </div>\n      \n      <div className=\"panel-content\">\n        <div className=\"option-group\">\n          <label>Pen Color</label>\n          <input \n            type=\"color\" \n            value={options.penColor || '#000000'} \n            onChange={(e) => handleChange('penColor', e.target.value)}\n          />\n        </div>\n        \n        <div className=\"option-group\">\n          <label>Pen Width</label>\n          <input \n            type=\"range\" \n            min=\"1\" \n            max=\"10\" \n            value={options.penWidth || 2} \n            onChange={(e) => handleChange('penWidth', parseInt(e.target.value))}\n          />\n          <span>{options.penWidth || 2}px</span>\n        </div>\n        \n        <div className=\"option-group\">\n          <label>Background Color</label>\n          <input \n            type=\"color\" \n            value={options.backgroundColor || '#ffffff'} \n            onChange={(e) => handleChange('backgroundColor', e.target.value)}\n          />\n        </div>\n        \n        <div className=\"option-group\">\n          <label>Drawing Mode</label>\n          <select \n            value={options.drawingMode || 'pen'} \n            onChange={(e) => handleChange('drawingMode', e.target.value as DrawingMode)}\n          >\n            <option value=\"pen\">Pen</option>\n            <option value=\"marker\">Marker</option>\n            <option value=\"highlighter\">Highlighter</option>\n          </select>\n        </div>\n        \n        <div className=\"option-group\">\n          <label>Min Width</label>\n          <input \n            type=\"range\" \n            min=\"0.5\" \n            max=\"5\" \n            step=\"0.5\" \n            value={options.minWidth || 0.5} \n            onChange={(e) => handleChange('minWidth', parseFloat(e.target.value))}\n          />\n          <span>{options.minWidth || 0.5}px</span>\n        </div>\n        \n        <div className=\"option-group\">\n          <label>Max Width</label>\n          <input \n            type=\"range\" \n            min=\"1\" \n            max=\"10\" \n            step=\"0.5\" \n            value={options.maxWidth || 2.5} \n            onChange={(e) => handleChange('maxWidth', parseFloat(e.target.value))}\n          />\n          <span>{options.maxWidth || 2.5}px</span>\n        </div>\n        \n        <div className=\"option-group\">\n          <label>Velocity Sensitivity</label>\n          <input \n            type=\"range\" \n            min=\"0.1\" \n            max=\"1\" \n            step=\"0.1\" \n            value={options.velocityFilterWeight || 0.7} \n            onChange={(e) => handleChange('velocityFilterWeight', parseFloat(e.target.value))}\n          />\n          <span>{options.velocityFilterWeight || 0.7}</span>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default SignatureCustomizationPanel;","import React, { useRef, useCallback, useEffect, useState } from 'react';\nimport { useSignature } from '../hooks/useSignature';\nimport { useUndoRedo } from '../hooks/useUndoRedo';\nimport { SignaturePadProps, SignatureOptions } from '../types';\nimport SignatureControls from './SignatureControls';\nimport SignatureCustomizationPanel from './SignatureCustomizationPanel';\n\nconst SignaturePad: React.FC<SignaturePadProps> = ({\n  onSave,\n  onUpload,\n  onClear,\n  onChange,\n  options = {},\n  className = '',\n  showControls = true,\n  showCustomization = true,\n  uploadButton = false,\n  uploadText = \"Upload Signature\",\n  saveButton = true,\n  saveText = \"Save Signature\",\n  clearButton = true,\n  clearText = \"Clear\",\n  maxWidth = 800,\n  maxHeight = 300,\n  theme = 'default',\n  showDarkModeToggle = false,\n}) => {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const containerRef = useRef<HTMLDivElement>(null);\n  const [isDrawing, setIsDrawing] = useState(false);\n  const [showCustomizationPanel, setShowCustomizationPanel] = useState(false);\n  const [customOptions, setCustomOptions] = useState(options);\n  \n  const {\n    isEmpty,\n    draw,\n    clear,\n    undo,\n    redo,\n    canUndo,\n    canRedo,\n    exportAsImage,\n    exportAsSVG,\n    toDataURL,\n    setDrawingMode,\n    setPenColor,\n    setPenWidth,\n    setBackgroundColor,\n    setMinWidth,\n    setMaxWidth,\n    setVelocityFilterWeight,\n    currentOptions\n  } = useSignature(canvasRef, customOptions);\n\n  const { addState, undo: undoHistory, redo: redoHistory, canUndo: canUndoHistory, canRedo: canRedoHistory } = \n    useUndoRedo(() => toDataURL('image/png'));\n\n  // Handle undo/redo with history\n  const handleUndo = useCallback(() => {\n    undoHistory();\n  }, [undoHistory]);\n\n  const handleRedo = useCallback(() => {\n    redoHistory();\n  }, [redoHistory]);\n\n  // Add state to history when drawing ends\n  useEffect(() => {\n    if (!isDrawing && !isEmpty) {\n      addState(toDataURL('image/png'));\n    }\n  }, [isDrawing, isEmpty, addState]);\n\n  // Notify parent when signature changes\n  useEffect(() => {\n    onChange?.(isEmpty);\n  }, [isEmpty, onChange]);\n\n  const handleSave = useCallback(() => {\n    const dataUrl = toDataURL('image/png');\n    onSave?.(dataUrl);\n  }, [toDataURL, onSave]);\n\n  const handleUpload = useCallback(() => {\n    const dataUrl = toDataURL('image/png');\n    if (onUpload) {\n      onUpload(dataUrl);\n    } else {\n      // Default upload behavior if no callback provided\n      const link = document.createElement('a');\n      link.download = 'signature.png';\n      link.href = dataUrl;\n      link.click();\n    }\n  }, [toDataURL, onUpload]);\n\n  const handleClear = useCallback(() => {\n  clear();\n  onClear?.();\n  addState(toDataURL('image/png'));\n  }, [clear, onClear, addState]);\n\n  const handleOptionsChange = useCallback((newOptions: Partial<SignatureOptions>) => {\n    setCustomOptions(prev => ({ ...prev, ...newOptions }));\n    \n    // Apply the changes to the signature hook\n    if (newOptions.penColor) setPenColor(newOptions.penColor);\n    if (newOptions.penWidth) setPenWidth(newOptions.penWidth);\n    if (newOptions.backgroundColor) setBackgroundColor(newOptions.backgroundColor);\n    if (newOptions.drawingMode) setDrawingMode(newOptions.drawingMode);\n    if (newOptions.minWidth) setMinWidth(newOptions.minWidth);\n    if (newOptions.maxWidth) setMaxWidth(newOptions.maxWidth);\n    if (newOptions.velocityFilterWeight) setVelocityFilterWeight(newOptions.velocityFilterWeight);\n  }, [setPenColor, setPenWidth, setBackgroundColor, setDrawingMode, setMinWidth, setMaxWidth, setVelocityFilterWeight]);\n\n  // Responsive canvas sizing\n  useEffect(() => {\n    const resizeCanvas = () => {\n      if (canvasRef.current && containerRef.current) {\n        const containerWidth = containerRef.current.clientWidth;\n        const width = Math.min(containerWidth, maxWidth);\n        const height = maxHeight;\n        \n        canvasRef.current.width = width;\n        canvasRef.current.height = height;\n        \n        // Redraw existing signature if any\n        if (!isEmpty) {\n          const dataUrl = toDataURL('image/png');\n          const ctx = canvasRef.current.getContext('2d');\n          if (ctx && dataUrl) {\n            const img = new Image();\n            img.onload = () => {\n              ctx.drawImage(img, 0, 0, width, height);\n            };\n            img.src = dataUrl;\n          }\n        } else {\n          // Clear and redraw background\n          const ctx = canvasRef.current.getContext('2d');\n          if (ctx && customOptions.backgroundColor) {\n            ctx.fillStyle = customOptions.backgroundColor;\n            ctx.fillRect(0, 0, width, height);\n          }\n        }\n      }\n    };\n\n    resizeCanvas();\n    window.addEventListener('resize', resizeCanvas);\n    \n    return () => {\n      window.removeEventListener('resize', resizeCanvas);\n    };\n  }, [isEmpty, toDataURL, maxWidth, maxHeight, customOptions.backgroundColor]);\n\n  const rootClasses = [\n    'react-signature-pad',\n    className,\n    theme === 'tailwind' ? 'sig-pad-container' : ''\n  ].filter(Boolean).join(' ');\n\n  return (\n    <div \n      className={rootClasses}\n      ref={containerRef}\n      style={{ maxWidth: `${maxWidth}px`, maxHeight: `${maxHeight + 100}px` }}\n    >\n      {showDarkModeToggle && (\n        <button\n          type=\"button\"\n          onClick={() => document.documentElement.classList.toggle('dark')}\n          className={theme === 'tailwind' ? 'sig-pad-dark-toggle' : 'customize-toggle'}\n          aria-label=\"Toggle dark mode\"\n        >\n          {theme === 'tailwind' ? (\n            <svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n              <path fillRule=\"evenodd\" d=\"M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z\" clipRule=\"evenodd\" />\n            </svg>\n          ) : (\n            'Dark Mode'\n          )}\n        </button>\n      )}\n      {showCustomization && (\n        <button \n          className={theme === 'tailwind' ? 'sig-pad-toolbar-btn mb-4' : 'customize-toggle'}\n          onClick={() => setShowCustomizationPanel(!showCustomizationPanel)}\n        >\n          {showCustomizationPanel ? 'Hide Options' : 'Customize'}\n        </button>\n      )}\n      \n      {showCustomizationPanel && (\n        <SignatureCustomizationPanel\n          options={customOptions}\n          onOptionsChange={handleOptionsChange}\n          onClose={() => setShowCustomizationPanel(false)}\n        />\n      )}\n      \n      {showControls && (\n        <SignatureControls\n          onUndo={handleUndo}\n          onRedo={handleRedo}\n          onClear={handleClear}\n          onSave={saveButton ? handleSave : undefined}\n          onUpload={uploadButton ? handleUpload : undefined}\n          onDrawingModeChange={setDrawingMode}\n          onPenColorChange={setPenColor}\n          onPenWidthChange={setPenWidth}\n          canUndo={canUndoHistory}\n          canRedo={canRedoHistory}\n          isEmpty={isEmpty}\n          currentOptions={currentOptions}\n          saveText={saveText}\n          uploadText={uploadText}\n          clearText={clearText}\n          theme={theme}\n        />\n      )}\n      \n  <div className={`signature-canvas-container ${theme === 'tailwind' ? 'sig-pad-canvas-container' : ''}`}>\n        <canvas\n          ref={canvasRef}\n          className={`signature-canvas ${theme === 'tailwind' ? 'sig-pad-canvas' : ''}`}\n          onMouseDown={(e) => {\n            setIsDrawing(true);\n            draw.start(e.nativeEvent);\n          }}\n          onMouseMove={(e) => {\n            if (isDrawing) {\n              draw.move(e.nativeEvent);\n            }\n          }}\n          onMouseUp={() => {\n            setIsDrawing(false);\n            draw.end();\n          }}\n          onMouseLeave={() => {\n            if (isDrawing) {\n              setIsDrawing(false);\n              draw.end();\n            }\n          }}\n          onTouchStart={(e) => {\n            setIsDrawing(true);\n            draw.start(e.nativeEvent);\n            e.preventDefault();\n          }}\n          onTouchMove={(e) => {\n            if (isDrawing) {\n              draw.move(e.nativeEvent);\n              e.preventDefault();\n            }\n          }}\n          onTouchEnd={() => {\n            setIsDrawing(false);\n            draw.end();\n          }}\n          onTouchCancel={() => {\n            setIsDrawing(false);\n            draw.end();\n          }}\n        />\n        {isEmpty && (\n          <div className={`signature-placeholder ${theme === 'tailwind' ? 'text-gray-400 dark:text-gray-500' : ''}`}>\n            Sign here\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default SignaturePad;","export const dataURLToBlob = (dataURL: string): Blob => {\n  const parts = dataURL.split(';base64,');\n  const contentType = parts[0].split(':')[1];\n  const raw = window.atob(parts[1]);\n  const uInt8Array = new Uint8Array(raw.length);\n  \n  for (let i = 0; i < raw.length; ++i) {\n    uInt8Array[i] = raw.charCodeAt(i);\n  }\n  \n  return new Blob([uInt8Array], { type: contentType });\n};\n\nexport const downloadDataURL = (dataURL: string, filename: string): void => {\n  const link = document.createElement('a');\n  link.download = filename;\n  link.href = dataURL;\n  link.click();\n};\n\nexport const dataURLToFile = (dataURL: string, filename: string): File => {\n  const blob = dataURLToBlob(dataURL);\n  return new File([blob], filename, { type: blob.type });\n};\n\nexport const uploadDataURL = async (\n  dataURL: string, \n  url: string, \n  fieldName: string = 'signature'\n): Promise<Response> => {\n  const formData = new FormData();\n  const file = dataURLToFile(dataURL, 'signature.png');\n  formData.append(fieldName, file);\n  \n  return fetch(url, {\n    method: 'POST',\n    body: formData\n  });\n};","import { Point } from '../types';\n\nexport const validateSignature = (points: Point[]): boolean => {\n  if (points.length < 5) return false;\n  \n  // Check if signature has enough complexity\n  const boundingBox = getBoundingBox(points);\n  const area = (boundingBox.maxX - boundingBox.minX) * (boundingBox.maxY - boundingBox.minY);\n  \n  if (area < 100) return false; // Too small\n  \n  // Check if signature has enough movement\n  const totalDistance = calculateTotalDistance(points);\n  if (totalDistance < 50) return false; // Not enough movement\n  \n  return true;\n};\n\nexport const getBoundingBox = (points: Point[]): { minX: number; minY: number; maxX: number; maxY: number } => {\n  if (points.length === 0) return { minX: 0, minY: 0, maxX: 0, maxY: 0 };\n  \n  let minX = points[0].x;\n  let minY = points[0].y;\n  let maxX = points[0].x;\n  let maxY = points[0].y;\n  \n  for (let i = 1; i < points.length; i++) {\n    minX = Math.min(minX, points[i].x);\n    minY = Math.min(minY, points[i].y);\n    maxX = Math.max(maxX, points[i].x);\n    maxY = Math.max(maxY, points[i].y);\n  }\n  \n  return { minX, minY, maxX, maxY };\n};\n\nexport const calculateTotalDistance = (points: Point[]): number => {\n  let distance = 0;\n  \n  for (let i = 1; i < points.length; i++) {\n    distance += Math.sqrt(\n      Math.pow(points[i].x - points[i - 1].x, 2) + \n      Math.pow(points[i].y - points[i - 1].y, 2)\n    );\n  }\n  \n  return distance;\n};\n\nexport const isSignatureEmpty = (dataURL: string): boolean => {\n  // Create a canvas to check if the signature is empty\n  const canvas = document.createElement('canvas');\n  const ctx = canvas.getContext('2d');\n  \n  if (!ctx) return true;\n  \n  const img = new Image();\n  img.src = dataURL;\n  \n  // This is a simplified check - in a real implementation, you'd need to wait for the image to load\n  // and then check if it has any non-transparent pixels\n  \n  return dataURL === '' || dataURL.includes('data:image/png;base64,AAAA');\n};"],"names":["useSignature","canvasRef","options","pointsRef","useRef","isEmpty","setIsEmpty","useState","currentOptions","setCurrentOptions","width","height","penColor","penWidth","backgroundColor","drawingMode","minWidth","maxWidth","velocityFilterWeight","useEffect","prev","canvas","current","ctx","getContext","lineCap","lineJoin","fillStyle","fillRect","draw","start","useCallback","event","rect","getBoundingClientRect","clientX","touches","clientY","point","x","left","y","top","time","Date","now","pressure","beginPath","moveTo","move","length","newPoint","points","push","velocity","lastPoint","secondLastPoint","distance","Math","sqrt","pow","timeDiff","calculateVelocity","baseWidth","max","globalAlpha","min","lineWidth","strokeStyle","lineTo","stroke","i","xc","yc","quadraticCurveTo","drawCurve","slice","end","clear","clearRect","toDataURL","type","quality","exportAsImage","filename","dataUrl","link","document","createElement","download","href","click","exportAsSVG","setDrawingMode","mode","setPenColor","color","setPenWidth","setBackgroundColor","img","Image","onload","drawImage","src","setMinWidth","setMaxWidth","setVelocityFilterWeight","weight","undo","redo","canUndo","canRedo","useUndoRedo","getCurrentState","history","setHistory","future","setFuture","maxHistorySize","addState","state","previousState","currentState","nextState","clearHistory","SignatureControls","onUndo","onRedo","onClear","onSave","onUpload","onDrawingModeChange","onPenColorChange","onPenWidthChange","saveText","uploadText","clearText","onDownload","onResetPen","showGrid","onToggleGrid","showEraser","onEraserMode","theme","btnCls","_jsxs","className","role","children","_jsx","onClick","disabled","title","value","onChange","e","target","parseInt","SignatureCustomizationPanel","onOptionsChange","onClose","handleChange","key","step","parseFloat","SignaturePad","showControls","showCustomization","uploadButton","saveButton","clearButton","maxHeight","showDarkModeToggle","containerRef","isDrawing","setIsDrawing","showCustomizationPanel","setShowCustomizationPanel","customOptions","setCustomOptions","undoHistory","redoHistory","canUndoHistory","canRedoHistory","handleUndo","handleRedo","handleSave","handleUpload","handleClear","handleOptionsChange","newOptions","resizeCanvas","containerWidth","clientWidth","window","addEventListener","removeEventListener","rootClasses","filter","Boolean","join","ref","style","documentElement","classList","toggle","fill","viewBox","fillRule","d","clipRule","undefined","onMouseDown","nativeEvent","onMouseMove","onMouseUp","onMouseLeave","onTouchStart","preventDefault","onTouchMove","onTouchEnd","onTouchCancel","dataURLToBlob","dataURL","parts","split","contentType","raw","atob","uInt8Array","Uint8Array","charCodeAt","Blob","downloadDataURL","dataURLToFile","blob","File","uploadDataURL","async","url","fieldName","formData","FormData","file","append","fetch","method","body","validateSignature","boundingBox","getBoundingBox","maxX","minX","maxY","minY","calculateTotalDistance","isSignatureEmpty","includes"],"mappings":"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"}