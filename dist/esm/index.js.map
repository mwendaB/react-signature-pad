{"version":3,"file":"index.js","sources":["../../../src/utils/drawingUtils.ts","../../../src/hooks/useSignature.ts","../../../src/hooks/useUndoRedo.ts","../../../src/components/SignatureControls.tsx","../../../src/components/SignatureCustomizationPanel.tsx","../../../src/components/SignaturePad.tsx","../../../src/utils/exportUtils.ts","../../../src/utils/validationUtils.ts"],"sourcesContent":["import { Point } from '../types';\n\nexport const drawCurve = (ctx: CanvasRenderingContext2D, points: Point[]): void => {\n  if (points.length < 3) {\n    const point = points[0];\n    ctx.lineTo(point.x, point.y);\n    ctx.stroke();\n    return;\n  }\n\n  ctx.beginPath();\n  ctx.moveTo(points[0].x, points[0].y);\n\n  for (let i = 1; i < points.length - 2; i++) {\n    const xc = (points[i].x + points[i + 1].x) / 2;\n    const yc = (points[i].y + points[i + 1].y) / 2;\n    ctx.quadraticCurveTo(points[i].x, points[i].y, xc, yc);\n  }\n\n  ctx.quadraticCurveTo(\n    points[points.length - 2].x,\n    points[points.length - 2].y,\n    points[points.length - 1].x,\n    points[points.length - 1].y\n  );\n\n  ctx.stroke();\n};\n\nexport const calculateVelocity = (points: Point[]): number => {\n  if (points.length < 2) return 0;\n\n  const lastPoint = points[points.length - 1];\n  const secondLastPoint = points[points.length - 2];\n  \n  const distance = Math.sqrt(\n    Math.pow(lastPoint.x - secondLastPoint.x, 2) + \n    Math.pow(lastPoint.y - secondLastPoint.y, 2)\n  );\n  \n  const timeDiff = lastPoint.time - secondLastPoint.time;\n  \n  return timeDiff > 0 ? distance / timeDiff : 0;\n};\n\nexport const getPressureBasedWidth = (\n  pressure: number, \n  minWidth: number, \n  maxWidth: number\n): number => {\n  return minWidth + (maxWidth - minWidth) * pressure;\n};\n\nexport const getVelocityBasedWidth = (\n  velocity: number, \n  baseWidth: number, \n  minWidth: number, \n  maxWidth: number\n): number => {\n  const newWidth = baseWidth - (velocity * baseWidth) / 5;\n  return Math.max(minWidth, Math.min(maxWidth, newWidth));\n};","import { useRef, useCallback, useEffect, useState } from 'react';\nimport { Point, SignatureOptions, DrawingMode, UseSignatureResult } from '../types';\nimport { drawCurve, calculateVelocity, getPressureBasedWidth, getVelocityBasedWidth } from '../utils/drawingUtils';\n\nexport const useSignature = (\n  canvasRef: React.RefObject<HTMLCanvasElement>, \n  options: Partial<SignatureOptions>\n): UseSignatureResult => {\n  const pointsRef = useRef<Point[]>([]);\n  const [isEmpty, setIsEmpty] = useState(true);\n  const [currentOptions, setCurrentOptions] = useState<SignatureOptions>({\n    width: options.width || 800,\n    height: options.height || 300,\n    penColor: options.penColor || '#000000',\n    penWidth: options.penWidth || 2,\n    backgroundColor: options.backgroundColor || '#ffffff',\n    drawingMode: options.drawingMode || 'pen',\n    minWidth: options.minWidth || 0.5,\n    maxWidth: options.maxWidth || 2.5,\n    velocityFilterWeight: options.velocityFilterWeight || 0.7,\n  });\n\n  // Update options when they change\n  useEffect(() => {\n    setCurrentOptions(prev => ({\n      ...prev,\n      ...options,\n      width: options.width || prev.width,\n      height: options.height || prev.height,\n    }));\n  }, [options]);\n\n  // Initialize canvas\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    \n    const ctx = canvas.getContext('2d');\n    if (!ctx) return;\n    \n    // Set initial styles\n    ctx.lineCap = 'round';\n    ctx.lineJoin = 'round';\n    ctx.fillStyle = currentOptions.backgroundColor;\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n    \n    setIsEmpty(true);\n  }, [canvasRef, currentOptions.backgroundColor]);\n\n  const draw = {\n    start: useCallback((event: MouseEvent | TouchEvent) => {\n      const canvas = canvasRef.current;\n      if (!canvas) return;\n      \n      const ctx = canvas.getContext('2d');\n      if (!ctx) return;\n      \n      const rect = canvas.getBoundingClientRect();\n      const clientX = 'touches' in event ? event.touches[0].clientX : event.clientX;\n      const clientY = 'touches' in event ? event.touches[0].clientY : event.clientY;\n      \n      const point: Point = {\n        x: clientX - rect.left,\n        y: clientY - rect.top,\n        time: Date.now(),\n        pressure: 'pressure' in event ? (event as any).pressure : 0.5\n      };\n      \n      pointsRef.current = [point];\n      setIsEmpty(false);\n      \n      ctx.beginPath();\n      ctx.moveTo(point.x, point.y);\n    }, [canvasRef]),\n    \n    move: useCallback((event: MouseEvent | TouchEvent) => {\n      if (pointsRef.current.length === 0) return;\n      \n      const canvas = canvasRef.current;\n      if (!canvas) return;\n      \n      const ctx = canvas.getContext('2d');\n      if (!ctx) return;\n      \n      const rect = canvas.getBoundingClientRect();\n      const clientX = 'touches' in event ? event.touches[0].clientX : event.clientX;\n      const clientY = 'touches' in event ? event.touches[0].clientY : event.clientY;\n      \n      const newPoint: Point = {\n        x: clientX - rect.left,\n        y: clientY - rect.top,\n        time: Date.now(),\n        pressure: 'pressure' in event ? (event as any).pressure : 0.5\n      };\n      \n      const points = pointsRef.current;\n      points.push(newPoint);\n      \n      // Calculate line width based on velocity or pressure\n      const velocity = calculateVelocity(points);\n      const baseWidth = currentOptions.penWidth;\n      \n      let width = baseWidth;\n      if (currentOptions.drawingMode === 'marker') {\n        width = Math.max(currentOptions.minWidth, baseWidth - (velocity * baseWidth) / 3);\n      } else if (currentOptions.drawingMode === 'highlighter') {\n        width = baseWidth + 2;\n        ctx.globalAlpha = 0.5;\n      } else {\n        width = Math.max(currentOptions.minWidth, Math.min(currentOptions.maxWidth, baseWidth - (velocity * baseWidth) / 5));\n      }\n      \n      ctx.lineWidth = width;\n      ctx.strokeStyle = currentOptions.penColor;\n      \n      // Draw smooth curve\n      drawCurve(ctx, points);\n      \n      // Reset alpha if using highlighter\n      if (currentOptions.drawingMode === 'highlighter') {\n        ctx.globalAlpha = 1;\n      }\n      \n      // Keep only recent points for performance\n      if (points.length > 5) {\n        pointsRef.current = points.slice(-5);\n      }\n    }, [canvasRef, currentOptions]),\n    \n    end: useCallback(() => {\n      pointsRef.current = [];\n    }, [])\n  };\n\n  const clear = useCallback(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    \n    const ctx = canvas.getContext('2d');\n    if (!ctx) return;\n    \n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    ctx.fillStyle = currentOptions.backgroundColor;\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n    \n    setIsEmpty(true);\n    pointsRef.current = [];\n  }, [canvasRef, currentOptions.backgroundColor]);\n\n  const toDataURL = useCallback((type?: string, quality?: number) => {\n    const canvas = canvasRef.current;\n    if (!canvas || isEmpty) return '';\n    return canvas.toDataURL(type, quality);\n  }, [canvasRef, isEmpty]);\n\n  const exportAsImage = useCallback((filename: string = 'signature') => {\n    const dataUrl = toDataURL('image/png');\n    if (!dataUrl) return;\n    \n    const link = document.createElement('a');\n    link.download = `${filename}.png`;\n    link.href = dataUrl;\n    link.click();\n  }, [toDataURL]);\n\n  const exportAsSVG = useCallback(() => {\n    // Implementation for SVG export\n    return ''; // Placeholder\n  }, []);\n\n  // Options setters\n  const setDrawingMode = useCallback((mode: DrawingMode) => {\n    setCurrentOptions(prev => ({ ...prev, drawingMode: mode }));\n  }, []);\n\n  const setPenColor = useCallback((color: string) => {\n    setCurrentOptions(prev => ({ ...prev, penColor: color }));\n  }, []);\n\n  const setPenWidth = useCallback((width: number) => {\n    setCurrentOptions(prev => ({ ...prev, penWidth: width }));\n  }, []);\n\n  const setBackgroundColor = useCallback((color: string) => {\n    setCurrentOptions(prev => ({ ...prev, backgroundColor: color }));\n    \n    // Redraw background if canvas exists\n    const canvas = canvasRef.current;\n    if (canvas) {\n      const ctx = canvas.getContext('2d');\n      if (ctx) {\n        ctx.fillStyle = color;\n        ctx.fillRect(0, 0, canvas.width, canvas.height);\n        \n        // Redraw signature if it exists\n        if (!isEmpty) {\n          const dataUrl = toDataURL('image/png');\n          if (dataUrl) {\n            const img = new Image();\n            img.onload = () => {\n              ctx.drawImage(img, 0, 0);\n            };\n            img.src = dataUrl;\n          }\n        }\n      }\n    }\n  }, [canvasRef, isEmpty, toDataURL]);\n\n  const setMinWidth = useCallback((width: number) => {\n    setCurrentOptions(prev => ({ ...prev, minWidth: width }));\n  }, []);\n\n  const setMaxWidth = useCallback((width: number) => {\n    setCurrentOptions(prev => ({ ...prev, maxWidth: width }));\n  }, []);\n\n  const setVelocityFilterWeight = useCallback((weight: number) => {\n    setCurrentOptions(prev => ({ ...prev, velocityFilterWeight: weight }));\n  }, []);\n\n  return {\n    isEmpty,\n    draw,\n    clear,\n    undo: () => {}, // Placeholder - would be implemented with useUndoRedo\n    redo: () => {}, // Placeholder\n    canUndo: false, // Placeholder\n    canRedo: false, // Placeholder\n    exportAsImage,\n    exportAsSVG,\n    toDataURL,\n    setDrawingMode,\n    setPenColor,\n    setPenWidth,\n    setBackgroundColor,\n    setMinWidth,\n    setMaxWidth,\n    setVelocityFilterWeight,\n    currentOptions\n  };\n};","import { useState, useCallback } from 'react';\nimport { UseUndoRedoResult } from '../types';\n\nexport const useUndoRedo = (getCurrentState: () => string): UseUndoRedoResult => {\n  const [history, setHistory] = useState<string[]>([]);\n  const [future, setFuture] = useState<string[]>([]);\n  const [maxHistorySize] = useState(50);\n\n  const addState = useCallback((state: string) => {\n    setHistory(prev => {\n      const newHistory = [...prev, state];\n      // Limit history size\n      return newHistory.slice(-maxHistorySize);\n    });\n    setFuture([]); // Clear future when adding a new state\n  }, [maxHistorySize]);\n\n  const undo = useCallback((): string | undefined => {\n    if (history.length === 0) return undefined;\n    \n    const previousState = history[history.length - 1];\n    const currentState = getCurrentState();\n    \n    setHistory(prev => prev.slice(0, -1));\n    setFuture(prev => [currentState, ...prev]);\n    \n    return previousState;\n  }, [history, getCurrentState]);\n\n  const redo = useCallback((): string | undefined => {\n    if (future.length === 0) return undefined;\n    \n    const nextState = future[0];\n    \n    setHistory(prev => [...prev, getCurrentState()]);\n    setFuture(prev => prev.slice(1));\n    \n    return nextState;\n  }, [future, getCurrentState]);\n\n  const clearHistory = useCallback((): void => {\n    setHistory([]);\n    setFuture([]);\n  }, []);\n\n  return {\n    addState,\n    undo,\n    redo,\n    canUndo: history.length > 0,\n    canRedo: future.length > 0,\n    clearHistory\n  };\n};","\nimport * as React from 'react';\nimport { SignatureControlsProps, DrawingMode } from '../types';\n\ninterface EnhancedSignatureControlsProps extends SignatureControlsProps {\n  onDownload?: () => void;\n  onResetPen?: () => void;\n  showGrid?: boolean;\n  onToggleGrid?: () => void;\n  showEraser?: boolean;\n  onEraserMode?: () => void;\n}\n\nconst SignatureControls: React.FC<EnhancedSignatureControlsProps> = ({\n  onUndo,\n  onRedo,\n  onClear,\n  onSave,\n  onUpload,\n  onDrawingModeChange,\n  onPenColorChange,\n  onPenWidthChange,\n  canUndo,\n  canRedo,\n  isEmpty,\n  currentOptions,\n  saveText = 'Save',\n  uploadText = 'Upload',\n  clearText = 'Clear',\n  onDownload,\n  onResetPen,\n  showGrid = false,\n  onToggleGrid,\n  showEraser = false,\n  onEraserMode\n}: EnhancedSignatureControlsProps) => {\n  return (\n    <div className=\"signature-controls\" role=\"toolbar\" aria-label=\"Signature controls\">\n      <div className=\"controls-left\">\n        <button \n          onClick={onUndo} \n          disabled={!canUndo}\n          className=\"control-button\"\n          title=\"Undo\"\n          aria-label=\"Undo\"\n        >\n          ↶\n        </button>\n        <button \n          onClick={onRedo} \n          disabled={!canRedo}\n          className=\"control-button\"\n          title=\"Redo\"\n          aria-label=\"Redo\"\n        >\n          ↷\n        </button>\n        <select \n          value={currentOptions.drawingMode} \n          onChange={(e: React.ChangeEvent<HTMLSelectElement>) => onDrawingModeChange(e.target.value as DrawingMode)}\n          className=\"control-select\"\n          aria-label=\"Drawing mode\"\n        >\n          <option value=\"pen\">Pen</option>\n          <option value=\"marker\">Marker</option>\n          <option value=\"highlighter\">Highlighter</option>\n          {showEraser && <option value=\"eraser\">Eraser</option>}\n        </select>\n        <input \n          type=\"color\" \n          value={currentOptions.penColor} \n          onChange={(e: React.ChangeEvent<HTMLInputElement>) => onPenColorChange(e.target.value)}\n          className=\"control-color\"\n          title=\"Pen Color\"\n          aria-label=\"Pen color\"\n        />\n        <input \n          type=\"range\" \n          min=\"1\" \n          max=\"10\" \n          value={currentOptions.penWidth} \n          onChange={(e: React.ChangeEvent<HTMLInputElement>) => onPenWidthChange(parseInt(e.target.value))}\n          className=\"control-slider\"\n          title=\"Pen Width\"\n          aria-label=\"Pen width\"\n        />\n        <span className=\"pen-width-label\" aria-label=\"Pen width value\">{currentOptions.penWidth}px</span>\n        {onResetPen && (\n          <button \n            onClick={onResetPen}\n            className=\"control-button\"\n            title=\"Reset Pen Settings\"\n            aria-label=\"Reset pen settings\"\n          >\n            Reset\n          </button>\n        )}\n        {showEraser && onEraserMode && (\n          <button \n            onClick={onEraserMode}\n            className=\"control-button\"\n            title=\"Eraser Mode\"\n            aria-label=\"Eraser mode\"\n          >\n            Eraser\n          </button>\n        )}\n        {onToggleGrid && (\n          <button \n            onClick={onToggleGrid}\n            className=\"control-button\"\n            title={showGrid ? \"Hide Grid\" : \"Show Grid\"}\n            aria-label={showGrid ? \"Hide grid\" : \"Show grid\"}\n          >\n            {showGrid ? \"Hide Grid\" : \"Show Grid\"}\n          </button>\n        )}\n      </div>\n      <div className=\"controls-right\">\n        <button \n          onClick={onClear} \n          className=\"control-button clear-button\"\n          title={clearText}\n          aria-label=\"Clear signature\"\n        >\n          {clearText}\n        </button>\n        {onSave && (\n          <button \n            onClick={onSave} \n            disabled={isEmpty}\n            className=\"control-button save-button\"\n            title={saveText}\n            aria-label=\"Save signature\"\n          >\n            {saveText}\n          </button>\n        )}\n        {onUpload && (\n          <button \n            onClick={onUpload} \n            disabled={isEmpty}\n            className=\"control-button upload-button\"\n            title={uploadText}\n            aria-label=\"Upload signature\"\n          >\n            {uploadText}\n          </button>\n        )}\n        {onDownload && (\n          <button \n            onClick={onDownload}\n            disabled={isEmpty}\n            className=\"control-button\"\n            title=\"Download signature\"\n            aria-label=\"Download signature\"\n          >\n            Download\n          </button>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default SignatureControls;","import React from 'react';\nimport { SignatureOptions, DrawingMode } from '../types';\n\ninterface SignatureCustomizationPanelProps {\n  options: Partial<SignatureOptions>;\n  onOptionsChange: (options: Partial<SignatureOptions>) => void;\n  onClose: () => void;\n}\n\nconst SignatureCustomizationPanel: React.FC<SignatureCustomizationPanelProps> = ({\n  options,\n  onOptionsChange,\n  onClose\n}) => {\n  const handleChange = (key: keyof SignatureOptions, value: any) => {\n    onOptionsChange({ [key]: value });\n  };\n\n  return (\n    <div className=\"signature-customization-panel\">\n      <div className=\"panel-header\">\n        <h3>Customize Signature</h3>\n        <button onClick={onClose} className=\"close-button\">×</button>\n      </div>\n      \n      <div className=\"panel-content\">\n        <div className=\"option-group\">\n          <label>Pen Color</label>\n          <input \n            type=\"color\" \n            value={options.penColor || '#000000'} \n            onChange={(e) => handleChange('penColor', e.target.value)}\n          />\n        </div>\n        \n        <div className=\"option-group\">\n          <label>Pen Width</label>\n          <input \n            type=\"range\" \n            min=\"1\" \n            max=\"10\" \n            value={options.penWidth || 2} \n            onChange={(e) => handleChange('penWidth', parseInt(e.target.value))}\n          />\n          <span>{options.penWidth || 2}px</span>\n        </div>\n        \n        <div className=\"option-group\">\n          <label>Background Color</label>\n          <input \n            type=\"color\" \n            value={options.backgroundColor || '#ffffff'} \n            onChange={(e) => handleChange('backgroundColor', e.target.value)}\n          />\n        </div>\n        \n        <div className=\"option-group\">\n          <label>Drawing Mode</label>\n          <select \n            value={options.drawingMode || 'pen'} \n            onChange={(e) => handleChange('drawingMode', e.target.value as DrawingMode)}\n          >\n            <option value=\"pen\">Pen</option>\n            <option value=\"marker\">Marker</option>\n            <option value=\"highlighter\">Highlighter</option>\n          </select>\n        </div>\n        \n        <div className=\"option-group\">\n          <label>Min Width</label>\n          <input \n            type=\"range\" \n            min=\"0.5\" \n            max=\"5\" \n            step=\"0.5\" \n            value={options.minWidth || 0.5} \n            onChange={(e) => handleChange('minWidth', parseFloat(e.target.value))}\n          />\n          <span>{options.minWidth || 0.5}px</span>\n        </div>\n        \n        <div className=\"option-group\">\n          <label>Max Width</label>\n          <input \n            type=\"range\" \n            min=\"1\" \n            max=\"10\" \n            step=\"0.5\" \n            value={options.maxWidth || 2.5} \n            onChange={(e) => handleChange('maxWidth', parseFloat(e.target.value))}\n          />\n          <span>{options.maxWidth || 2.5}px</span>\n        </div>\n        \n        <div className=\"option-group\">\n          <label>Velocity Sensitivity</label>\n          <input \n            type=\"range\" \n            min=\"0.1\" \n            max=\"1\" \n            step=\"0.1\" \n            value={options.velocityFilterWeight || 0.7} \n            onChange={(e) => handleChange('velocityFilterWeight', parseFloat(e.target.value))}\n          />\n          <span>{options.velocityFilterWeight || 0.7}</span>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default SignatureCustomizationPanel;","import React, { useRef, useCallback, useEffect, useState } from 'react';\nimport { useSignature } from '../hooks/useSignature';\nimport { useUndoRedo } from '../hooks/useUndoRedo';\nimport { SignaturePadProps, SignatureOptions } from '../types';\nimport SignatureControls from './SignatureControls';\nimport SignatureCustomizationPanel from './SignatureCustomizationPanel';\n\nconst SignaturePad: React.FC<SignaturePadProps> = ({\n  onSave,\n  onUpload,\n  onClear,\n  onChange,\n  options = {},\n  className = '',\n  showControls = true,\n  showCustomization = true,\n  uploadButton = false,\n  uploadText = \"Upload Signature\",\n  saveButton = true,\n  saveText = \"Save Signature\",\n  clearButton = true,\n  clearText = \"Clear\",\n  maxWidth = 800,\n  maxHeight = 300,\n}) => {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const containerRef = useRef<HTMLDivElement>(null);\n  const [isDrawing, setIsDrawing] = useState(false);\n  const [showCustomizationPanel, setShowCustomizationPanel] = useState(false);\n  const [customOptions, setCustomOptions] = useState(options);\n  \n  const {\n    isEmpty,\n    draw,\n    clear,\n    undo,\n    redo,\n    canUndo,\n    canRedo,\n    exportAsImage,\n    exportAsSVG,\n    toDataURL,\n    setDrawingMode,\n    setPenColor,\n    setPenWidth,\n    setBackgroundColor,\n    setMinWidth,\n    setMaxWidth,\n    setVelocityFilterWeight,\n    currentOptions\n  } = useSignature(canvasRef, customOptions);\n\n  const { addState, undo: undoHistory, redo: redoHistory, canUndo: canUndoHistory, canRedo: canRedoHistory } = \n    useUndoRedo(() => toDataURL('image/png'));\n\n  // Handle undo/redo with history\n  const handleUndo = useCallback(() => {\n    undoHistory();\n  }, [undoHistory]);\n\n  const handleRedo = useCallback(() => {\n    redoHistory();\n  }, [redoHistory]);\n\n  // Add state to history when drawing ends\n  useEffect(() => {\n    if (!isDrawing && !isEmpty) {\n      addState(toDataURL('image/png'));\n    }\n  }, [isDrawing, isEmpty, addState]);\n\n  // Notify parent when signature changes\n  useEffect(() => {\n    onChange?.(isEmpty);\n  }, [isEmpty, onChange]);\n\n  const handleSave = useCallback(() => {\n    const dataUrl = toDataURL('image/png');\n    onSave?.(dataUrl);\n  }, [toDataURL, onSave]);\n\n  const handleUpload = useCallback(() => {\n    const dataUrl = toDataURL('image/png');\n    if (onUpload) {\n      onUpload(dataUrl);\n    } else {\n      // Default upload behavior if no callback provided\n      const link = document.createElement('a');\n      link.download = 'signature.png';\n      link.href = dataUrl;\n      link.click();\n    }\n  }, [toDataURL, onUpload]);\n\n  const handleClear = useCallback(() => {\n  clear();\n  onClear?.();\n  addState(toDataURL('image/png'));\n  }, [clear, onClear, addState]);\n\n  const handleOptionsChange = useCallback((newOptions: Partial<SignatureOptions>) => {\n    setCustomOptions(prev => ({ ...prev, ...newOptions }));\n    \n    // Apply the changes to the signature hook\n    if (newOptions.penColor) setPenColor(newOptions.penColor);\n    if (newOptions.penWidth) setPenWidth(newOptions.penWidth);\n    if (newOptions.backgroundColor) setBackgroundColor(newOptions.backgroundColor);\n    if (newOptions.drawingMode) setDrawingMode(newOptions.drawingMode);\n    if (newOptions.minWidth) setMinWidth(newOptions.minWidth);\n    if (newOptions.maxWidth) setMaxWidth(newOptions.maxWidth);\n    if (newOptions.velocityFilterWeight) setVelocityFilterWeight(newOptions.velocityFilterWeight);\n  }, [setPenColor, setPenWidth, setBackgroundColor, setDrawingMode, setMinWidth, setMaxWidth, setVelocityFilterWeight]);\n\n  // Responsive canvas sizing\n  useEffect(() => {\n    const resizeCanvas = () => {\n      if (canvasRef.current && containerRef.current) {\n        const containerWidth = containerRef.current.clientWidth;\n        const width = Math.min(containerWidth, maxWidth);\n        const height = maxHeight;\n        \n        canvasRef.current.width = width;\n        canvasRef.current.height = height;\n        \n        // Redraw existing signature if any\n        if (!isEmpty) {\n          const dataUrl = toDataURL('image/png');\n          const ctx = canvasRef.current.getContext('2d');\n          if (ctx && dataUrl) {\n            const img = new Image();\n            img.onload = () => {\n              ctx.drawImage(img, 0, 0, width, height);\n            };\n            img.src = dataUrl;\n          }\n        } else {\n          // Clear and redraw background\n          const ctx = canvasRef.current.getContext('2d');\n          if (ctx && customOptions.backgroundColor) {\n            ctx.fillStyle = customOptions.backgroundColor;\n            ctx.fillRect(0, 0, width, height);\n          }\n        }\n      }\n    };\n\n    resizeCanvas();\n    window.addEventListener('resize', resizeCanvas);\n    \n    return () => {\n      window.removeEventListener('resize', resizeCanvas);\n    };\n  }, [isEmpty, toDataURL, maxWidth, maxHeight, customOptions.backgroundColor]);\n\n  return (\n    <div \n      className={`react-signature-pad ${className}`} \n      ref={containerRef}\n      style={{ maxWidth: `${maxWidth}px`, maxHeight: `${maxHeight + 100}px` }}\n    >\n      {showCustomization && (\n        <button \n          className=\"customize-toggle\"\n          onClick={() => setShowCustomizationPanel(!showCustomizationPanel)}\n        >\n          {showCustomizationPanel ? 'Hide Options' : 'Customize'}\n        </button>\n      )}\n      \n      {showCustomizationPanel && (\n        <SignatureCustomizationPanel\n          options={customOptions}\n          onOptionsChange={handleOptionsChange}\n          onClose={() => setShowCustomizationPanel(false)}\n        />\n      )}\n      \n      {showControls && (\n        <SignatureControls\n          onUndo={handleUndo}\n          onRedo={handleRedo}\n          onClear={handleClear}\n          onSave={saveButton ? handleSave : undefined}\n          onUpload={uploadButton ? handleUpload : undefined}\n          onDrawingModeChange={setDrawingMode}\n          onPenColorChange={setPenColor}\n          onPenWidthChange={setPenWidth}\n          canUndo={canUndoHistory}\n          canRedo={canRedoHistory}\n          isEmpty={isEmpty}\n          currentOptions={currentOptions}\n          saveText={saveText}\n          uploadText={uploadText}\n          clearText={clearText}\n        />\n      )}\n      \n      <div className=\"signature-canvas-container\">\n        <canvas\n          ref={canvasRef}\n          className=\"signature-canvas\"\n          onMouseDown={(e) => {\n            setIsDrawing(true);\n            draw.start(e.nativeEvent);\n          }}\n          onMouseMove={(e) => {\n            if (isDrawing) {\n              draw.move(e.nativeEvent);\n            }\n          }}\n          onMouseUp={() => {\n            setIsDrawing(false);\n            draw.end();\n          }}\n          onMouseLeave={() => {\n            if (isDrawing) {\n              setIsDrawing(false);\n              draw.end();\n            }\n          }}\n          onTouchStart={(e) => {\n            setIsDrawing(true);\n            draw.start(e.nativeEvent);\n            e.preventDefault();\n          }}\n          onTouchMove={(e) => {\n            if (isDrawing) {\n              draw.move(e.nativeEvent);\n              e.preventDefault();\n            }\n          }}\n          onTouchEnd={() => {\n            setIsDrawing(false);\n            draw.end();\n          }}\n          onTouchCancel={() => {\n            setIsDrawing(false);\n            draw.end();\n          }}\n        />\n        {isEmpty && (\n          <div className=\"signature-placeholder\">\n            Sign here\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default SignaturePad;","export const dataURLToBlob = (dataURL: string): Blob => {\n  const parts = dataURL.split(';base64,');\n  const contentType = parts[0].split(':')[1];\n  const raw = window.atob(parts[1]);\n  const uInt8Array = new Uint8Array(raw.length);\n  \n  for (let i = 0; i < raw.length; ++i) {\n    uInt8Array[i] = raw.charCodeAt(i);\n  }\n  \n  return new Blob([uInt8Array], { type: contentType });\n};\n\nexport const downloadDataURL = (dataURL: string, filename: string): void => {\n  const link = document.createElement('a');\n  link.download = filename;\n  link.href = dataURL;\n  link.click();\n};\n\nexport const dataURLToFile = (dataURL: string, filename: string): File => {\n  const blob = dataURLToBlob(dataURL);\n  return new File([blob], filename, { type: blob.type });\n};\n\nexport const uploadDataURL = async (\n  dataURL: string, \n  url: string, \n  fieldName: string = 'signature'\n): Promise<Response> => {\n  const formData = new FormData();\n  const file = dataURLToFile(dataURL, 'signature.png');\n  formData.append(fieldName, file);\n  \n  return fetch(url, {\n    method: 'POST',\n    body: formData\n  });\n};","import { Point } from '../types';\n\nexport const validateSignature = (points: Point[]): boolean => {\n  if (points.length < 5) return false;\n  \n  // Check if signature has enough complexity\n  const boundingBox = getBoundingBox(points);\n  const area = (boundingBox.maxX - boundingBox.minX) * (boundingBox.maxY - boundingBox.minY);\n  \n  if (area < 100) return false; // Too small\n  \n  // Check if signature has enough movement\n  const totalDistance = calculateTotalDistance(points);\n  if (totalDistance < 50) return false; // Not enough movement\n  \n  return true;\n};\n\nexport const getBoundingBox = (points: Point[]): { minX: number; minY: number; maxX: number; maxY: number } => {\n  if (points.length === 0) return { minX: 0, minY: 0, maxX: 0, maxY: 0 };\n  \n  let minX = points[0].x;\n  let minY = points[0].y;\n  let maxX = points[0].x;\n  let maxY = points[0].y;\n  \n  for (let i = 1; i < points.length; i++) {\n    minX = Math.min(minX, points[i].x);\n    minY = Math.min(minY, points[i].y);\n    maxX = Math.max(maxX, points[i].x);\n    maxY = Math.max(maxY, points[i].y);\n  }\n  \n  return { minX, minY, maxX, maxY };\n};\n\nexport const calculateTotalDistance = (points: Point[]): number => {\n  let distance = 0;\n  \n  for (let i = 1; i < points.length; i++) {\n    distance += Math.sqrt(\n      Math.pow(points[i].x - points[i - 1].x, 2) + \n      Math.pow(points[i].y - points[i - 1].y, 2)\n    );\n  }\n  \n  return distance;\n};\n\nexport const isSignatureEmpty = (dataURL: string): boolean => {\n  // Create a canvas to check if the signature is empty\n  const canvas = document.createElement('canvas');\n  const ctx = canvas.getContext('2d');\n  \n  if (!ctx) return true;\n  \n  const img = new Image();\n  img.src = dataURL;\n  \n  // This is a simplified check - in a real implementation, you'd need to wait for the image to load\n  // and then check if it has any non-transparent pixels\n  \n  return dataURL === '' || dataURL.includes('data:image/png;base64,AAAA');\n};"],"names":["useSignature","canvasRef","options","pointsRef","useRef","isEmpty","setIsEmpty","useState","currentOptions","setCurrentOptions","width","height","penColor","penWidth","backgroundColor","drawingMode","minWidth","maxWidth","velocityFilterWeight","useEffect","prev","canvas","current","ctx","getContext","lineCap","lineJoin","fillStyle","fillRect","draw","start","useCallback","event","rect","getBoundingClientRect","clientX","touches","clientY","point","x","left","y","top","time","Date","now","pressure","beginPath","moveTo","move","length","newPoint","points","push","velocity","lastPoint","secondLastPoint","distance","Math","sqrt","pow","timeDiff","calculateVelocity","baseWidth","max","globalAlpha","min","lineWidth","strokeStyle","lineTo","stroke","i","xc","yc","quadraticCurveTo","drawCurve","slice","end","clear","clearRect","toDataURL","type","quality","exportAsImage","filename","dataUrl","link","document","createElement","download","href","click","exportAsSVG","setDrawingMode","mode","setPenColor","color","setPenWidth","setBackgroundColor","img","Image","onload","drawImage","src","setMinWidth","setMaxWidth","setVelocityFilterWeight","weight","undo","redo","canUndo","canRedo","useUndoRedo","getCurrentState","history","setHistory","future","setFuture","maxHistorySize","addState","state","previousState","currentState","nextState","clearHistory","SignatureControls","onUndo","onRedo","onClear","onSave","onUpload","onDrawingModeChange","onPenColorChange","onPenWidthChange","saveText","uploadText","clearText","onDownload","onResetPen","showGrid","onToggleGrid","showEraser","onEraserMode","_jsxs","className","role","children","_jsx","onClick","disabled","title","value","onChange","e","target","parseInt","SignatureCustomizationPanel","onOptionsChange","onClose","handleChange","key","step","parseFloat","SignaturePad","showControls","showCustomization","uploadButton","saveButton","clearButton","maxHeight","containerRef","isDrawing","setIsDrawing","showCustomizationPanel","setShowCustomizationPanel","customOptions","setCustomOptions","undoHistory","redoHistory","canUndoHistory","canRedoHistory","handleUndo","handleRedo","handleSave","handleUpload","handleClear","handleOptionsChange","newOptions","resizeCanvas","containerWidth","clientWidth","window","addEventListener","removeEventListener","ref","style","undefined","onMouseDown","nativeEvent","onMouseMove","onMouseUp","onMouseLeave","onTouchStart","preventDefault","onTouchMove","onTouchEnd","onTouchCancel","dataURLToBlob","dataURL","parts","split","contentType","raw","atob","uInt8Array","Uint8Array","charCodeAt","Blob","downloadDataURL","dataURLToFile","blob","File","uploadDataURL","async","url","fieldName","formData","FormData","file","append","fetch","method","body","validateSignature","boundingBox","getBoundingBox","maxX","minX","maxY","minY","calculateTotalDistance","isSignatureEmpty","includes"],"mappings":"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"}