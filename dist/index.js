"use strict";var e=require("react/jsx-runtime"),t=require("react");const n=(e,n)=>{const a=t.useRef([]),[o,l]=t.useState(!0),[r,i]=t.useState({width:n.width||800,height:n.height||300,penColor:n.penColor||"#000000",penWidth:n.penWidth||2,backgroundColor:n.backgroundColor||"#ffffff",drawingMode:n.drawingMode||"pen",minWidth:n.minWidth||.5,maxWidth:n.maxWidth||2.5,velocityFilterWeight:n.velocityFilterWeight||.7});t.useEffect(()=>{i(e=>({...e,...n,width:n.width||e.width,height:n.height||e.height}))},[n]),t.useEffect(()=>{const t=e.current;if(!t)return;const n=t.getContext("2d");n&&(n.lineCap="round",n.lineJoin="round",n.fillStyle=r.backgroundColor,n.fillRect(0,0,t.width,t.height),l(!0))},[e,r.backgroundColor]);const s={start:t.useCallback(t=>{const n=e.current;if(!n)return;const o=n.getContext("2d");if(!o)return;const r=n.getBoundingClientRect(),i="touches"in t?t.touches[0].clientX:t.clientX,s="touches"in t?t.touches[0].clientY:t.clientY,d={x:i-r.left,y:s-r.top,time:Date.now(),pressure:"pressure"in t?t.pressure:.5};a.current=[d],l(!1),o.beginPath(),o.moveTo(d.x,d.y)},[e]),move:t.useCallback(t=>{if(0===a.current.length)return;const n=e.current;if(!n)return;const o=n.getContext("2d");if(!o)return;const l=n.getBoundingClientRect(),i="touches"in t?t.touches[0].clientX:t.clientX,s="touches"in t?t.touches[0].clientY:t.clientY,d={x:i-l.left,y:s-l.top,time:Date.now(),pressure:"pressure"in t?t.pressure:.5},c=a.current;c.push(d);const u=(e=>{if(e.length<2)return 0;const t=e[e.length-1],n=e[e.length-2],a=Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2)),o=t.time-n.time;return o>0?a/o:0})(c),h=r.penWidth;let g=h;"marker"===r.drawingMode?g=Math.max(r.minWidth,h-u*h/3):"highlighter"===r.drawingMode?(g=h+2,o.globalAlpha=.5):g=Math.max(r.minWidth,Math.min(r.maxWidth,h-u*h/5)),o.lineWidth=g,o.strokeStyle=r.penColor,((e,t)=>{if(t.length<3){const n=t[0];return e.lineTo(n.x,n.y),void e.stroke()}e.beginPath(),e.moveTo(t[0].x,t[0].y);for(let n=1;n<t.length-2;n++){const a=(t[n].x+t[n+1].x)/2,o=(t[n].y+t[n+1].y)/2;e.quadraticCurveTo(t[n].x,t[n].y,a,o)}e.quadraticCurveTo(t[t.length-2].x,t[t.length-2].y,t[t.length-1].x,t[t.length-1].y),e.stroke()})(o,c),"highlighter"===r.drawingMode&&(o.globalAlpha=1),c.length>5&&(a.current=c.slice(-5))},[e,r]),end:t.useCallback(()=>{a.current=[]},[])},d=t.useCallback(()=>{const t=e.current;if(!t)return;const n=t.getContext("2d");n&&(n.clearRect(0,0,t.width,t.height),n.fillStyle=r.backgroundColor,n.fillRect(0,0,t.width,t.height),l(!0),a.current=[])},[e,r.backgroundColor]),c=t.useCallback((t,n)=>{const a=e.current;return!a||o?"":a.toDataURL(t,n)},[e,o]),u=t.useCallback((e="signature")=>{const t=c("image/png");if(!t)return;const n=document.createElement("a");n.download=`${e}.png`,n.href=t,n.click()},[c]),h=t.useCallback(()=>"",[]),g=t.useCallback(e=>{i(t=>({...t,drawingMode:e}))},[]),p=t.useCallback(e=>{i(t=>({...t,penColor:e}))},[]),x=t.useCallback(e=>{i(t=>({...t,penWidth:e}))},[]),m=t.useCallback(t=>{i(e=>({...e,backgroundColor:t}));const n=e.current;if(n){const e=n.getContext("2d");if(e&&(e.fillStyle=t,e.fillRect(0,0,n.width,n.height),!o)){const t=c("image/png");if(t){const n=new Image;n.onload=()=>{e.drawImage(n,0,0)},n.src=t}}}},[e,o,c]),C=t.useCallback(e=>{i(t=>({...t,minWidth:e}))},[]),b=t.useCallback(e=>{i(t=>({...t,maxWidth:e}))},[]),v=t.useCallback(e=>{i(t=>({...t,velocityFilterWeight:e}))},[]);return{isEmpty:o,draw:s,clear:d,undo:()=>{},redo:()=>{},canUndo:!1,canRedo:!1,exportAsImage:u,exportAsSVG:h,toDataURL:c,setDrawingMode:g,setPenColor:p,setPenWidth:x,setBackgroundColor:m,setMinWidth:C,setMaxWidth:b,setVelocityFilterWeight:v,currentOptions:r}},a=e=>{const[n,a]=t.useState([]),[o,l]=t.useState([]),[r]=t.useState(50),i=t.useCallback(e=>{a(t=>[...t,e].slice(-r)),l([])},[r]),s=t.useCallback(()=>{if(0===n.length)return;const t=n[n.length-1],o=e();return a(e=>e.slice(0,-1)),l(e=>[o,...e]),t},[n,e]),d=t.useCallback(()=>{if(0===o.length)return;const t=o[0];return a(t=>[...t,e()]),l(e=>e.slice(1)),t},[o,e]),c=t.useCallback(()=>{a([]),l([])},[]);return{addState:i,undo:s,redo:d,canUndo:n.length>0,canRedo:o.length>0,clearHistory:c}},o=({onUndo:t,onRedo:n,onClear:a,onSave:o,onUpload:l,onDrawingModeChange:r,onPenColorChange:i,onPenWidthChange:s,canUndo:d,canRedo:c,isEmpty:u,currentOptions:h,saveText:g="Save",uploadText:p="Upload",clearText:x="Clear",onDownload:m,onResetPen:C,showGrid:b=!1,onToggleGrid:v,showEraser:w=!1,onEraserMode:f,theme:k="default"})=>{const j="tailwind"===k?"sig-pad-toolbar-btn":"control-button",y="tailwind"===k?"signature-controls flex flex-wrap gap-2 mb-2":"signature-controls";return e.jsxs("div",{className:y,role:"toolbar","aria-label":"Signature controls",children:[e.jsxs("div",{className:"controls-left flex items-center gap-2 flex-wrap",children:[e.jsx("button",{onClick:t,disabled:!d,className:j,title:"Undo","aria-label":"Undo",children:"↶"}),e.jsx("button",{onClick:n,disabled:!c,className:j,title:"Redo","aria-label":"Redo",children:"↷"}),e.jsxs("select",{value:h.drawingMode,onChange:e=>r(e.target.value),className:"tailwind"===k?"control-select h-8 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-sm px-2":"control-select","aria-label":"Drawing mode",children:[e.jsx("option",{value:"pen",children:"Pen"}),e.jsx("option",{value:"marker",children:"Marker"}),e.jsx("option",{value:"highlighter",children:"Highlighter"}),w&&e.jsx("option",{value:"eraser",children:"Eraser"})]}),e.jsx("input",{type:"color",value:h.penColor,onChange:e=>i(e.target.value),className:"tailwind"===k?"control-color h-8 w-10 border border-gray-300 dark:border-gray-600 rounded-md overflow-hidden":"control-color",title:"Pen Color","aria-label":"Pen color"}),e.jsx("input",{type:"range",min:"1",max:"10",value:h.penWidth,onChange:e=>s(parseInt(e.target.value)),className:"tailwind"===k?"control-slider cursor-pointer accent-brand-600":"control-slider",title:"Pen Width","aria-label":"Pen width"}),e.jsxs("span",{className:"pen-width-label","aria-label":"Pen width value",children:[h.penWidth,"px"]}),C&&e.jsx("button",{onClick:C,className:j,title:"Reset Pen Settings","aria-label":"Reset pen settings",children:"Reset"}),w&&f&&e.jsx("button",{onClick:f,className:j,title:"Eraser Mode","aria-label":"Eraser mode",children:"Eraser"}),v&&e.jsx("button",{onClick:v,className:j,title:b?"Hide Grid":"Show Grid","aria-label":b?"Hide grid":"Show grid",children:b?"Hide Grid":"Show Grid"})]}),e.jsxs("div",{className:"controls-right flex items-center gap-2 flex-wrap",children:[e.jsx("button",{onClick:a,className:`${j} clear-button`,title:x,"aria-label":"Clear signature",children:x}),o&&e.jsx("button",{onClick:o,disabled:u,className:`${j} save-button`,title:g,"aria-label":"Save signature",children:g}),l&&e.jsx("button",{onClick:l,disabled:u,className:`${j} upload-button`,title:p,"aria-label":"Upload signature",children:p}),m&&e.jsx("button",{onClick:m,disabled:u,className:j,title:"Download signature","aria-label":"Download signature",children:"Download"})]})]})},l=({options:t,onOptionsChange:n,onClose:a})=>{const o=(e,t)=>{n({[e]:t})};return e.jsxs("div",{className:"signature-customization-panel",children:[e.jsxs("div",{className:"panel-header",children:[e.jsx("h3",{children:"Customize Signature"}),e.jsx("button",{onClick:a,className:"close-button",children:"×"})]}),e.jsxs("div",{className:"panel-content",children:[e.jsxs("div",{className:"option-group",children:[e.jsx("label",{children:"Pen Color"}),e.jsx("input",{type:"color",value:t.penColor||"#000000",onChange:e=>o("penColor",e.target.value)})]}),e.jsxs("div",{className:"option-group",children:[e.jsx("label",{children:"Pen Width"}),e.jsx("input",{type:"range",min:"1",max:"10",value:t.penWidth||2,onChange:e=>o("penWidth",parseInt(e.target.value))}),e.jsxs("span",{children:[t.penWidth||2,"px"]})]}),e.jsxs("div",{className:"option-group",children:[e.jsx("label",{children:"Background Color"}),e.jsx("input",{type:"color",value:t.backgroundColor||"#ffffff",onChange:e=>o("backgroundColor",e.target.value)})]}),e.jsxs("div",{className:"option-group",children:[e.jsx("label",{children:"Drawing Mode"}),e.jsxs("select",{value:t.drawingMode||"pen",onChange:e=>o("drawingMode",e.target.value),children:[e.jsx("option",{value:"pen",children:"Pen"}),e.jsx("option",{value:"marker",children:"Marker"}),e.jsx("option",{value:"highlighter",children:"Highlighter"})]})]}),e.jsxs("div",{className:"option-group",children:[e.jsx("label",{children:"Min Width"}),e.jsx("input",{type:"range",min:"0.5",max:"5",step:"0.5",value:t.minWidth||.5,onChange:e=>o("minWidth",parseFloat(e.target.value))}),e.jsxs("span",{children:[t.minWidth||.5,"px"]})]}),e.jsxs("div",{className:"option-group",children:[e.jsx("label",{children:"Max Width"}),e.jsx("input",{type:"range",min:"1",max:"10",step:"0.5",value:t.maxWidth||2.5,onChange:e=>o("maxWidth",parseFloat(e.target.value))}),e.jsxs("span",{children:[t.maxWidth||2.5,"px"]})]}),e.jsxs("div",{className:"option-group",children:[e.jsx("label",{children:"Velocity Sensitivity"}),e.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.1",value:t.velocityFilterWeight||.7,onChange:e=>o("velocityFilterWeight",parseFloat(e.target.value))}),e.jsx("span",{children:t.velocityFilterWeight||.7})]})]})]})},r=e=>{const t=e.split(";base64,"),n=t[0].split(":")[1],a=window.atob(t[1]),o=new Uint8Array(a.length);for(let e=0;e<a.length;++e)o[e]=a.charCodeAt(e);return new Blob([o],{type:n})},i=(e,t)=>{const n=r(e);return new File([n],t,{type:n.type})},s=e=>{if(0===e.length)return{minX:0,minY:0,maxX:0,maxY:0};let t=e[0].x,n=e[0].y,a=e[0].x,o=e[0].y;for(let l=1;l<e.length;l++)t=Math.min(t,e[l].x),n=Math.min(n,e[l].y),a=Math.max(a,e[l].x),o=Math.max(o,e[l].y);return{minX:t,minY:n,maxX:a,maxY:o}},d=e=>{let t=0;for(let n=1;n<e.length;n++)t+=Math.sqrt(Math.pow(e[n].x-e[n-1].x,2)+Math.pow(e[n].y-e[n-1].y,2));return t};exports.SignaturePad=({onSave:r,onUpload:i,onClear:s,onChange:d,options:c={},className:u="",showControls:h=!0,showCustomization:g=!0,uploadButton:p=!1,uploadText:x="Upload Signature",saveButton:m=!0,saveText:C="Save Signature",clearButton:b=!0,clearText:v="Clear",maxWidth:w=800,maxHeight:f=300,theme:k="default",showDarkModeToggle:j=!1})=>{const y=t.useRef(null),W=t.useRef(null),[M,S]=t.useState(!1),[N,R]=t.useState(!1),[E,U]=t.useState(c),{isEmpty:T,draw:D,clear:P,undo:z,redo:F,canUndo:B,canRedo:A,exportAsImage:L,exportAsSVG:H,toDataURL:X,setDrawingMode:Y,setPenColor:I,setPenWidth:G,setBackgroundColor:O,setMinWidth:q,setMaxWidth:V,setVelocityFilterWeight:$,currentOptions:J}=n(y,E),{addState:K,undo:Q,redo:Z,canUndo:_,canRedo:ee}=a(()=>X("image/png")),te=t.useCallback(()=>{Q()},[Q]),ne=t.useCallback(()=>{Z()},[Z]);t.useEffect(()=>{M||T||K(X("image/png"))},[M,T,K]),t.useEffect(()=>{null==d||d(T)},[T,d]);const ae=t.useCallback(()=>{const e=X("image/png");null==r||r(e)},[X,r]),oe=t.useCallback(()=>{const e=X("image/png");if(i)i(e);else{const t=document.createElement("a");t.download="signature.png",t.href=e,t.click()}},[X,i]),le=t.useCallback(()=>{P(),null==s||s(),K(X("image/png"))},[P,s,K]),re=t.useCallback(e=>{U(t=>({...t,...e})),e.penColor&&I(e.penColor),e.penWidth&&G(e.penWidth),e.backgroundColor&&O(e.backgroundColor),e.drawingMode&&Y(e.drawingMode),e.minWidth&&q(e.minWidth),e.maxWidth&&V(e.maxWidth),e.velocityFilterWeight&&$(e.velocityFilterWeight)},[I,G,O,Y,q,V,$]);t.useEffect(()=>{const e=()=>{if(y.current&&W.current){const e=W.current.clientWidth,t=Math.min(e,w),n=f;if(y.current.width=t,y.current.height=n,T){const e=y.current.getContext("2d");e&&E.backgroundColor&&(e.fillStyle=E.backgroundColor,e.fillRect(0,0,t,n))}else{const e=X("image/png"),a=y.current.getContext("2d");if(a&&e){const o=new Image;o.onload=()=>{a.drawImage(o,0,0,t,n)},o.src=e}}}};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[T,X,w,f,E.backgroundColor]);const ie=["react-signature-pad",u,"tailwind"===k?"sig-pad-container":""].filter(Boolean).join(" ");return e.jsxs("div",{className:ie,ref:W,style:{maxWidth:`${w}px`,maxHeight:`${f+100}px`},children:[j&&e.jsx("button",{type:"button",onClick:()=>document.documentElement.classList.toggle("dark"),className:"tailwind"===k?"sig-pad-dark-toggle":"customize-toggle","aria-label":"Toggle dark mode",children:"tailwind"===k?e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z",clipRule:"evenodd"})}):"Dark Mode"}),g&&e.jsx("button",{className:"tailwind"===k?"sig-pad-toolbar-btn mb-4":"customize-toggle",onClick:()=>R(!N),children:N?"Hide Options":"Customize"}),N&&e.jsx(l,{options:E,onOptionsChange:re,onClose:()=>R(!1)}),h&&e.jsx(o,{onUndo:te,onRedo:ne,onClear:le,onSave:m?ae:void 0,onUpload:p?oe:void 0,onDrawingModeChange:Y,onPenColorChange:I,onPenWidthChange:G,canUndo:_,canRedo:ee,isEmpty:T,currentOptions:J,saveText:C,uploadText:x,clearText:v,theme:k}),e.jsxs("div",{className:"signature-canvas-container "+("tailwind"===k?"sig-pad-canvas-container":""),children:[e.jsx("canvas",{ref:y,className:"signature-canvas "+("tailwind"===k?"sig-pad-canvas":""),onMouseDown:e=>{S(!0),D.start(e.nativeEvent)},onMouseMove:e=>{M&&D.move(e.nativeEvent)},onMouseUp:()=>{S(!1),D.end()},onMouseLeave:()=>{M&&(S(!1),D.end())},onTouchStart:e=>{S(!0),D.start(e.nativeEvent),e.preventDefault()},onTouchMove:e=>{M&&(D.move(e.nativeEvent),e.preventDefault())},onTouchEnd:()=>{S(!1),D.end()},onTouchCancel:()=>{S(!1),D.end()}}),T&&e.jsx("div",{className:"signature-placeholder "+("tailwind"===k?"text-gray-400 dark:text-gray-500":""),children:"Sign here"})]})]})},exports.calculateTotalDistance=d,exports.dataURLToBlob=r,exports.dataURLToFile=i,exports.downloadDataURL=(e,t)=>{const n=document.createElement("a");n.download=t,n.href=e,n.click()},exports.getBoundingBox=s,exports.isSignatureEmpty=e=>{if(!document.createElement("canvas").getContext("2d"))return!0;return(new Image).src=e,""===e||e.includes("data:image/png;base64,AAAA")},exports.uploadDataURL=async(e,t,n="signature")=>{const a=new FormData,o=i(e,"signature.png");return a.append(n,o),fetch(t,{method:"POST",body:a})},exports.useSignature=n,exports.useUndoRedo=a,exports.validateSignature=e=>{if(e.length<5)return!1;const t=s(e);if((t.maxX-t.minX)*(t.maxY-t.minY)<100)return!1;return!(d(e)<50)};
//# sourceMappingURL=index.js.map
