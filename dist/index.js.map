{"version":3,"file":"index.js","sources":["../../src/utils/classNames.ts","../../src/components/SignaturePad/SignatureCanvas.tsx","../../src/components/ui/Select.tsx","../../src/components/ui/Slider.tsx","../../src/components/SignaturePad/SignatureToolbar.tsx","../../src/components/ui/Button.tsx","../../src/components/SignaturePad/SignatureActionBar.tsx","../../src/components/ui/ColorPicker.tsx","../../src/components/SignaturePad/SignatureSettingsPanel.tsx","../../src/utils/drawingUtils.ts","../node_modules/uuid/dist/stringify.js","../node_modules/uuid/dist/rng.js","../node_modules/uuid/dist/native.js","../node_modules/uuid/dist/v4.js","../../src/hooks/useSignature.ts","../../src/hooks/useUndoRedo.ts","../../src/hooks/useSignaturePad.ts","../../src/components/SignaturePad/EnhancedSignaturePad.tsx","../../src/components/SignaturePad.tsx","../../src/utils/exportUtils.ts","../../src/utils/validationUtils.ts"],"sourcesContent":["/**\n * Utility function for combining class names\n * Simple alternative to clsx for combining conditional classes\n */\nexport function cn(...inputs: (string | undefined | null | boolean)[]) {\n  return inputs.filter(Boolean).join(' ');\n}\n\n/**\n * Creates a conditional class name based on a condition\n */\nexport function conditionalClass(condition: boolean, trueClass: string, falseClass = '') {\n  return condition ? trueClass : falseClass;\n}\n\n/**\n * Merges theme-specific classes\n */\nexport function themeClass(theme: 'default' | 'tailwind', defaultClass: string, tailwindClass: string) {\n  return theme === 'tailwind' ? tailwindClass : defaultClass;\n}","import React, { useEffect, useRef } from 'react';\nimport { cn, themeClass } from '../../utils/classNames';\nimport { SignatureOptions } from '../../types';\n\ninterface SignatureCanvasProps {\n  canvasRef: React.RefObject<HTMLCanvasElement>;\n  isEmpty: boolean;\n  isDrawing: boolean;\n  onDrawStart: (event: MouseEvent | TouchEvent) => void;\n  onDrawMove: (event: MouseEvent | TouchEvent) => void;\n  onDrawEnd: () => void;\n  maxWidth?: number;\n  maxHeight?: number;\n  theme?: 'default' | 'tailwind';\n  className?: string;\n  placeholder?: React.ReactNode;\n  options: SignatureOptions;\n}\n\nconst defaultPlaceholder = (\n  <div className=\"flex flex-col items-center justify-center text-gray-400 dark:text-gray-500 pointer-events-none select-none\">\n    <svg className=\"w-12 h-12 mb-3 text-gray-300 dark:text-gray-600 animate-pulse\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z\" />\n    </svg>\n    <p className=\"text-base font-medium mb-1\">Sign here</p>\n    <p className=\"text-sm text-gray-300 dark:text-gray-600\">Draw your signature in the box above</p>\n  </div>\n);\n\nexport const SignatureCanvas: React.FC<SignatureCanvasProps> = ({\n  canvasRef,\n  isEmpty,\n  isDrawing,\n  onDrawStart,\n  onDrawMove,\n  onDrawEnd,\n  maxWidth = 800,\n  maxHeight = 300,\n  theme = 'default',\n  className,\n  placeholder = defaultPlaceholder,\n  options\n}) => {\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  // Handle canvas resizing\n  useEffect(() => {\n    const resizeCanvas = () => {\n      if (canvasRef.current && containerRef.current) {\n        const containerWidth = containerRef.current.clientWidth;\n        const width = Math.min(containerWidth, maxWidth);\n        const height = maxHeight;\n        \n        const canvas = canvasRef.current;\n        const ctx = canvas.getContext('2d');\n        \n        // Save current canvas data\n        const imageData = ctx?.getImageData(0, 0, canvas.width, canvas.height);\n        \n        // Resize canvas\n        canvas.width = width;\n        canvas.height = height;\n        \n        // Restore canvas data if it existed\n        if (ctx && imageData && !isEmpty) {\n          ctx.putImageData(imageData, 0, 0);\n        } else if (ctx && options.backgroundColor) {\n          // Set background color\n          ctx.fillStyle = options.backgroundColor;\n          ctx.fillRect(0, 0, width, height);\n        }\n      }\n    };\n\n    resizeCanvas();\n    window.addEventListener('resize', resizeCanvas);\n    \n    return () => {\n      window.removeEventListener('resize', resizeCanvas);\n    };\n  }, [canvasRef, maxWidth, maxHeight, isEmpty, options.backgroundColor]);\n\n  // Mouse event handlers\n  const handleMouseDown = (e: React.MouseEvent<HTMLCanvasElement>) => {\n    onDrawStart(e.nativeEvent);\n  };\n\n  const handleMouseMove = (e: React.MouseEvent<HTMLCanvasElement>) => {\n    if (isDrawing) {\n      onDrawMove(e.nativeEvent);\n    }\n  };\n\n  const handleMouseUp = () => {\n    if (isDrawing) {\n      onDrawEnd();\n    }\n  };\n\n  const handleMouseLeave = () => {\n    if (isDrawing) {\n      onDrawEnd();\n    }\n  };\n\n  // Touch event handlers\n  const handleTouchStart = (e: React.TouchEvent<HTMLCanvasElement>) => {\n    e.preventDefault();\n    onDrawStart(e.nativeEvent);\n  };\n\n  const handleTouchMove = (e: React.TouchEvent<HTMLCanvasElement>) => {\n    e.preventDefault();\n    if (isDrawing) {\n      onDrawMove(e.nativeEvent);\n    }\n  };\n\n  const handleTouchEnd = (e: React.TouchEvent<HTMLCanvasElement>) => {\n    e.preventDefault();\n    if (isDrawing) {\n      onDrawEnd();\n    }\n  };\n\n  const containerClasses = cn(\n    'relative',\n    themeClass(\n      theme,\n      'signature-canvas-container',\n      'sig-pad-canvas-container'\n    ),\n    className\n  );\n\n  const canvasClasses = cn(\n    'block cursor-crosshair touch-none',\n    themeClass(\n      theme,\n      'signature-canvas',\n      'sig-pad-canvas'\n    ),\n    isDrawing && 'cursor-grabbing'\n  );\n\n  return (\n    <div \n      ref={containerRef}\n      className={containerClasses}\n      style={{ maxWidth: `${maxWidth}px`, height: `${maxHeight}px` }}\n    >\n      <canvas\n        ref={canvasRef}\n        className={canvasClasses}\n        onMouseDown={handleMouseDown}\n        onMouseMove={handleMouseMove}\n        onMouseUp={handleMouseUp}\n        onMouseLeave={handleMouseLeave}\n        onTouchStart={handleTouchStart}\n        onTouchMove={handleTouchMove}\n        onTouchEnd={handleTouchEnd}\n        onTouchCancel={handleTouchEnd}\n        role=\"img\"\n        aria-label=\"Signature canvas\"\n        aria-describedby=\"signature-instructions\"\n      />\n      \n      {isEmpty && (\n        <div \n          className={cn(\n            'absolute inset-0 flex items-center justify-center pointer-events-none',\n            themeClass(\n              theme,\n              'signature-placeholder',\n              'sig-pad-placeholder'\n            )\n          )}\n        >\n          {placeholder}\n        </div>\n      )}\n      \n      {/* Screen reader instructions */}\n      <div id=\"signature-instructions\" className=\"sr-only\">\n        Use mouse or touch to draw your signature in this area. \n        Use the controls below to undo, clear, or save your signature.\n      </div>\n    </div>\n  );\n};","import React from 'react';\nimport { cn } from '../../utils/classNames';\n\ninterface SelectProps extends Omit<React.SelectHTMLAttributes<HTMLSelectElement>, 'onChange'> {\n  value: string;\n  onChange: (value: string) => void;\n  options: Array<{ value: string; label: string; disabled?: boolean }>;\n  label?: string;\n  placeholder?: string;\n  error?: string;\n}\n\nexport const Select: React.FC<SelectProps> = ({\n  value,\n  onChange,\n  options,\n  label,\n  placeholder,\n  error,\n  className,\n  disabled,\n  ...props\n}) => {\n  return (\n    <div className={cn('flex flex-col gap-1.5', className)}>\n      {label && (\n        <label className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\n          {label}\n        </label>\n      )}\n      \n      <div className=\"relative\">\n        <select\n          value={value}\n          onChange={(e) => onChange(e.target.value)}\n          disabled={disabled}\n          className={cn(\n            'w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg appearance-none',\n            'bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100',\n            'focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-brand-500',\n            'hover:border-gray-400 dark:hover:border-gray-500',\n            'transition-colors duration-200',\n            disabled && 'opacity-50 cursor-not-allowed bg-gray-50 dark:bg-gray-700',\n            error && 'border-red-500 focus:border-red-500 focus:ring-red-500'\n          )}\n          {...props}\n        >\n          {placeholder && (\n            <option value=\"\" disabled hidden>\n              {placeholder}\n            </option>\n          )}\n          {options.map((option) => (\n            <option\n              key={option.value}\n              value={option.value}\n              disabled={option.disabled}\n            >\n              {option.label}\n            </option>\n          ))}\n        </select>\n        \n        {/* Custom dropdown arrow */}\n        <div className=\"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none\">\n          <svg className=\"h-4 w-4 text-gray-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n          </svg>\n        </div>\n      </div>\n      \n      {error && (\n        <p className=\"text-sm text-red-600 dark:text-red-400\">{error}</p>\n      )}\n    </div>\n  );\n};","import React from 'react';\nimport { cn } from '../../utils/classNames';\n\ninterface SliderProps extends Omit<React.InputHTMLAttributes<HTMLInputElement>, 'onChange'> {\n  value: number;\n  onChange: (value: number) => void;\n  min?: number;\n  max?: number;\n  step?: number;\n  label?: string;\n  showValue?: boolean;\n  unit?: string;\n  variant?: 'default' | 'brand';\n}\n\nexport const Slider: React.FC<SliderProps> = ({\n  value,\n  onChange,\n  min = 0,\n  max = 100,\n  step = 1,\n  label,\n  showValue = true,\n  unit = '',\n  variant = 'default',\n  className,\n  disabled,\n  ...props\n}) => {\n  return (\n    <div className={cn('flex flex-col gap-2', className)}>\n      {label && (\n        <div className=\"flex justify-between items-center\">\n          <label className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\n            {label}\n          </label>\n          {showValue && (\n            <span className=\"text-sm text-gray-500 dark:text-gray-400 font-mono\">\n              {value}{unit}\n            </span>\n          )}\n        </div>\n      )}\n      <input\n        type=\"range\"\n        min={min}\n        max={max}\n        step={step}\n        value={value}\n        onChange={(e) => onChange(Number(e.target.value))}\n        disabled={disabled}\n        className={cn(\n          'w-full h-2 rounded-lg appearance-none cursor-pointer transition-all duration-200',\n          'bg-gray-200 dark:bg-gray-700',\n          variant === 'brand' && 'accent-brand-600',\n          variant === 'default' && 'accent-gray-600',\n          'hover:bg-gray-300 dark:hover:bg-gray-600',\n          'focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500',\n          disabled && 'opacity-50 cursor-not-allowed',\n          // Webkit slider thumb styles\n          '[&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-brand-600 [&::-webkit-slider-thumb]:cursor-pointer [&::-webkit-slider-thumb]:shadow-lg [&::-webkit-slider-thumb]:hover:bg-brand-700 [&::-webkit-slider-thumb]:transition-colors',\n          // Firefox slider thumb styles  \n          '[&::-moz-range-thumb]:h-4 [&::-moz-range-thumb]:w-4 [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:bg-brand-600 [&::-moz-range-thumb]:cursor-pointer [&::-moz-range-thumb]:border-none [&::-moz-range-thumb]:shadow-lg'\n        )}\n        {...props}\n      />\n    </div>\n  );\n};","import React from 'react';\nimport { cn, themeClass } from '../../utils/classNames';\nimport { Button } from '../ui/Button';\nimport { Select } from '../ui/Select';\nimport { ColorPicker } from '../ui/ColorPicker';\nimport { Slider } from '../ui/Slider';\nimport { DrawingMode, SignatureOptions } from '../../types';\n\ninterface SignatureToolbarProps {\n  currentOptions: SignatureOptions;\n  onPenColorChange: (color: string) => void;\n  onPenWidthChange: (width: number) => void;\n  onDrawingModeChange: (mode: DrawingMode) => void;\n  theme?: 'default' | 'tailwind';\n  className?: string;\n  compact?: boolean;\n}\n\nconst drawingModeOptions = [\n  { value: 'pen', label: 'Pen' },\n  { value: 'marker', label: 'Marker' },\n  { value: 'highlighter', label: 'Highlighter' }\n];\n\nexport const SignatureToolbar: React.FC<SignatureToolbarProps> = ({\n  currentOptions,\n  onPenColorChange,\n  onPenWidthChange,\n  onDrawingModeChange,\n  theme = 'default',\n  className,\n  compact = false\n}) => {\n  const containerClasses = cn(\n    'flex items-center gap-3 p-3 rounded-lg border',\n    themeClass(\n      theme,\n      'bg-gray-50 border-gray-200',\n      'bg-gray-50/50 dark:bg-gray-800/30 backdrop-blur-sm border-gray-200 dark:border-gray-700'\n    ),\n    compact && 'p-2 gap-2',\n    className\n  );\n\n  return (\n    <div className={containerClasses} role=\"toolbar\" aria-label=\"Drawing tools\">\n      {/* Drawing Mode */}\n      <div className=\"flex items-center gap-2\">\n        <label className=\"text-sm font-medium text-gray-700 dark:text-gray-300 whitespace-nowrap\">\n          Mode:\n        </label>\n        <Select\n          value={currentOptions.drawingMode}\n          onChange={(value) => onDrawingModeChange(value as DrawingMode)}\n          options={drawingModeOptions}\n          className={cn('min-w-0', compact ? 'w-20' : 'w-24')}\n        />\n      </div>\n\n      {/* Color Picker */}\n      <div className=\"flex items-center gap-2\">\n        <label className=\"text-sm font-medium text-gray-700 dark:text-gray-300 whitespace-nowrap\">\n          Color:\n        </label>\n        <div className=\"relative\">\n          <input\n            type=\"color\"\n            value={currentOptions.penColor}\n            onChange={(e) => onPenColorChange(e.target.value)}\n            className={cn(\n              'h-8 w-10 border-2 border-gray-300 dark:border-gray-600 rounded-md overflow-hidden cursor-pointer transition-all duration-200',\n              'hover:scale-105 hover:shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500',\n              themeClass(theme, '', 'sig-pad-color-input')\n            )}\n            title={`Current color: ${currentOptions.penColor}`}\n            aria-label=\"Pen color\"\n          />\n        </div>\n      </div>\n\n      {/* Pen Width */}\n      <div className=\"flex items-center gap-2 flex-1 min-w-0\">\n        <label className=\"text-sm font-medium text-gray-700 dark:text-gray-300 whitespace-nowrap\">\n          Size:\n        </label>\n        <div className=\"flex-1 min-w-0\">\n          <Slider\n            value={currentOptions.penWidth}\n            onChange={onPenWidthChange}\n            min={1}\n            max={10}\n            step={1}\n            showValue={!compact}\n            unit=\"px\"\n            variant=\"brand\"\n            className=\"min-w-0\"\n          />\n        </div>\n        {compact && (\n          <span className=\"text-xs text-gray-500 dark:text-gray-400 font-mono min-w-0\">\n            {currentOptions.penWidth}px\n          </span>\n        )}\n      </div>\n\n      {/* Pen Preview */}\n      <div className=\"flex items-center\">\n        <div className=\"relative flex items-center justify-center w-8 h-8\">\n          <div\n            className=\"rounded-full border border-gray-200 dark:border-gray-600\"\n            style={{\n              backgroundColor: currentOptions.penColor,\n              width: `${Math.max(4, Math.min(currentOptions.penWidth * 2, 16))}px`,\n              height: `${Math.max(4, Math.min(currentOptions.penWidth * 2, 16))}px`,\n              opacity: currentOptions.drawingMode === 'highlighter' ? 0.5 : 1\n            }}\n            title={`Preview: ${currentOptions.penWidth}px ${currentOptions.drawingMode}`}\n            aria-label=\"Pen preview\"\n          />\n        </div>\n      </div>\n    </div>\n  );\n};","import React from 'react';\nimport { cn } from '../../utils/classNames';\n\nexport type ButtonVariant = 'primary' | 'secondary' | 'tertiary' | 'danger' | 'ghost';\nexport type ButtonSize = 'sm' | 'md' | 'lg';\n\ninterface ButtonProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {\n  variant?: ButtonVariant;\n  size?: ButtonSize;\n  loading?: boolean;\n  icon?: React.ReactNode;\n  iconPosition?: 'left' | 'right';\n  children?: React.ReactNode;\n}\n\nconst buttonVariants = {\n  primary: 'bg-brand-600 hover:bg-brand-700 text-white border-brand-600 hover:border-brand-700 shadow-brand-200/50 dark:shadow-brand-900/50',\n  secondary: 'bg-white hover:bg-gray-50 text-gray-700 border-gray-300 hover:border-gray-400 dark:bg-gray-800 dark:hover:bg-gray-700 dark:text-gray-200 dark:border-gray-600',\n  tertiary: 'bg-transparent hover:bg-gray-50 text-gray-600 hover:text-gray-700 border-transparent hover:border-gray-200 dark:hover:bg-gray-800 dark:text-gray-400 dark:hover:text-gray-300',\n  danger: 'bg-red-600 hover:bg-red-700 text-white border-red-600 hover:border-red-700 shadow-red-200/50 dark:shadow-red-900/50',\n  ghost: 'bg-transparent hover:bg-gray-100 text-gray-600 hover:text-gray-700 border-transparent dark:hover:bg-gray-800 dark:text-gray-400'\n};\n\nconst buttonSizes = {\n  sm: 'px-3 py-1.5 text-sm',\n  md: 'px-4 py-2 text-sm',\n  lg: 'px-6 py-3 text-base'\n};\n\nexport const Button: React.FC<ButtonProps> = ({\n  variant = 'secondary',\n  size = 'md',\n  loading = false,\n  icon,\n  iconPosition = 'left',\n  className,\n  disabled,\n  children,\n  ...props\n}) => {\n  const isDisabled = disabled || loading;\n\n  return (\n    <button\n      className={cn(\n        // Base styles\n        'inline-flex items-center justify-center font-medium border rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500',\n        \n        // Size variants\n        buttonSizes[size],\n        \n        // Color variants\n        buttonVariants[variant],\n        \n        // Disabled state\n        isDisabled && 'opacity-50 cursor-not-allowed pointer-events-none',\n        \n        // Hover effects\n        !isDisabled && 'hover:scale-[1.02] active:scale-[0.98] hover:shadow-md',\n        \n        className\n      )}\n      disabled={isDisabled}\n      {...props}\n    >\n      {loading && (\n        <svg className=\"animate-spin -ml-1 mr-2 h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\">\n          <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"/>\n          <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"/>\n        </svg>\n      )}\n      \n      {!loading && icon && iconPosition === 'left' && (\n        <span className={cn('mr-2', children ? '' : 'mr-0')}>{icon}</span>\n      )}\n      \n      {children}\n      \n      {!loading && icon && iconPosition === 'right' && (\n        <span className={cn('ml-2', children ? '' : 'ml-0')}>{icon}</span>\n      )}\n    </button>\n  );\n};","import React from 'react';\nimport { cn, themeClass } from '../../utils/classNames';\nimport { Button } from '../ui/Button';\n\ninterface SignatureActionBarProps {\n  onUndo: () => void;\n  onRedo: () => void;\n  onClear: () => void;\n  onSave?: () => void;\n  onUpload?: () => void;\n  canUndo: boolean;\n  canRedo: boolean;\n  isEmpty: boolean;\n  loading?: boolean;\n  theme?: 'default' | 'tailwind';\n  className?: string;\n  \n  // Button customization\n  saveText?: string;\n  uploadText?: string;\n  clearText?: string;\n  showSave?: boolean;\n  showUpload?: boolean;\n  showClear?: boolean;\n}\n\n// Icon components\nconst UndoIcon = () => (\n  <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6\" />\n  </svg>\n);\n\nconst RedoIcon = () => (\n  <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M21 10H11a8 8 0 00-8 8v2m18-10l-6-6m6 6l-6 6\" />\n  </svg>\n);\n\nconst ClearIcon = () => (\n  <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\n  </svg>\n);\n\nconst SaveIcon = () => (\n  <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4\" />\n  </svg>\n);\n\nconst UploadIcon = () => (\n  <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10\" />\n  </svg>\n);\n\nexport const SignatureActionBar: React.FC<SignatureActionBarProps> = ({\n  onUndo,\n  onRedo,\n  onClear,\n  onSave,\n  onUpload,\n  canUndo,\n  canRedo,\n  isEmpty,\n  loading = false,\n  theme = 'default',\n  className,\n  saveText = 'Save',\n  uploadText = 'Upload',\n  clearText = 'Clear',\n  showSave = true,\n  showUpload = false,\n  showClear = true\n}) => {\n  const containerClasses = cn(\n    'flex items-center justify-between gap-4 p-3 rounded-lg border',\n    themeClass(\n      theme,\n      'bg-white border-gray-200',\n      'bg-white/80 dark:bg-gray-900/80 backdrop-blur-sm border-gray-200 dark:border-gray-700'\n    ),\n    className\n  );\n\n  return (\n    <div className={containerClasses} role=\"toolbar\" aria-label=\"Signature actions\">\n      {/* History Controls */}\n      <div className=\"flex items-center gap-2\">\n        <Button\n          onClick={onUndo}\n          disabled={!canUndo}\n          variant=\"ghost\"\n          size=\"sm\"\n          icon={<UndoIcon />}\n          aria-label=\"Undo last action\"\n          title=\"Undo (Ctrl+Z)\"\n        />\n        \n        <Button\n          onClick={onRedo}\n          disabled={!canRedo}\n          variant=\"ghost\"\n          size=\"sm\"\n          icon={<RedoIcon />}\n          aria-label=\"Redo last action\"\n          title=\"Redo (Ctrl+Y)\"\n        />\n      </div>\n\n      {/* Main Actions */}\n      <div className=\"flex items-center gap-2\">\n        {showClear && (\n          <Button\n            onClick={onClear}\n            variant=\"secondary\"\n            size=\"sm\"\n            icon={<ClearIcon />}\n            disabled={isEmpty}\n            aria-label=\"Clear signature\"\n            title=\"Clear all\"\n          >\n            {clearText}\n          </Button>\n        )}\n\n        {showSave && onSave && (\n          <Button\n            onClick={onSave}\n            variant=\"primary\"\n            size=\"sm\"\n            icon={<SaveIcon />}\n            disabled={isEmpty}\n            loading={loading}\n            aria-label=\"Save signature\"\n            title=\"Save signature\"\n          >\n            {saveText}\n          </Button>\n        )}\n\n        {showUpload && onUpload && (\n          <Button\n            onClick={onUpload}\n            variant=\"secondary\"\n            size=\"sm\"\n            icon={<UploadIcon />}\n            disabled={isEmpty}\n            loading={loading}\n            aria-label=\"Upload signature\"\n            title=\"Upload signature\"\n          >\n            {uploadText}\n          </Button>\n        )}\n      </div>\n    </div>\n  );\n};","import React from 'react';\nimport { cn } from '../../utils/classNames';\n\ninterface ColorPickerProps {\n  value: string;\n  onChange: (color: string) => void;\n  label?: string;\n  disabled?: boolean;\n  className?: string;\n  presets?: string[];\n}\n\nexport const ColorPicker: React.FC<ColorPickerProps> = ({\n  value,\n  onChange,\n  label,\n  disabled,\n  className,\n  presets = ['#000000', '#374151', '#DC2626', '#EA580C', '#D97706', '#CA8A04', '#65A30D', '#16A34A', '#059669', '#0891B2', '#0284C7', '#2563EB', '#7C3AED', '#9333EA', '#C026D3', '#DB2777']\n}) => {\n  return (\n    <div className={cn('flex flex-col gap-2', className)}>\n      {label && (\n        <label className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\n          {label}\n        </label>\n      )}\n      \n      <div className=\"flex items-center gap-3\">\n        {/* Native color input */}\n        <div className=\"relative\">\n          <input\n            type=\"color\"\n            value={value}\n            onChange={(e) => onChange(e.target.value)}\n            disabled={disabled}\n            className={cn(\n              'h-10 w-12 border-2 border-gray-200 dark:border-gray-600 rounded-lg overflow-hidden shadow-sm cursor-pointer transition-all duration-200',\n              'hover:shadow-md hover:scale-105 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500',\n              disabled && 'opacity-50 cursor-not-allowed'\n            )}\n          />\n          <div className=\"absolute inset-0 rounded-lg border-2 border-gray-200 dark:border-gray-600 pointer-events-none\" />\n        </div>\n\n        {/* Color value display */}\n        <div className=\"flex-1\">\n          <input\n            type=\"text\"\n            value={value.toUpperCase()}\n            onChange={(e) => {\n              const color = e.target.value;\n              if (/^#[0-9A-F]{6}$/i.test(color)) {\n                onChange(color);\n              }\n            }}\n            disabled={disabled}\n            placeholder=\"#000000\"\n            className={cn(\n              'w-full px-3 py-2 text-sm font-mono border border-gray-300 dark:border-gray-600 rounded-lg',\n              'bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100',\n              'focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-brand-500',\n              'placeholder:text-gray-400 dark:placeholder:text-gray-500',\n              disabled && 'opacity-50 cursor-not-allowed'\n            )}\n          />\n        </div>\n      </div>\n\n      {/* Color presets */}\n      <div className=\"flex flex-wrap gap-1.5 mt-1\">\n        {presets.map((color) => (\n          <button\n            key={color}\n            type=\"button\"\n            onClick={() => onChange(color)}\n            disabled={disabled}\n            className={cn(\n              'w-6 h-6 rounded-full border-2 border-gray-200 dark:border-gray-600 cursor-pointer transition-all duration-200',\n              'hover:scale-110 hover:shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500',\n              value === color && 'ring-2 ring-brand-500 ring-offset-2',\n              disabled && 'opacity-50 cursor-not-allowed'\n            )}\n            style={{ backgroundColor: color }}\n            title={color}\n          />\n        ))}\n      </div>\n    </div>\n  );\n};","import React, { useState } from 'react';\nimport { cn, themeClass } from '../../utils/classNames';\nimport { Button } from '../ui/Button';\nimport { ColorPicker } from '../ui/ColorPicker';\nimport { Slider } from '../ui/Slider';\nimport { Select } from '../ui/Select';\nimport { DrawingMode, SignatureOptions } from '../../types';\n\ninterface SignatureSettingsPanelProps {\n  options: Partial<SignatureOptions>;\n  onOptionsChange: (options: Partial<SignatureOptions>) => void;\n  onClose: () => void;\n  theme?: 'default' | 'tailwind';\n  className?: string;\n}\n\nconst drawingModeOptions = [\n  { value: 'pen', label: 'Pen - Smooth, variable width' },\n  { value: 'marker', label: 'Marker - Consistent width' },\n  { value: 'highlighter', label: 'Highlighter - Semi-transparent' }\n];\n\nconst SettingsIcon = () => (\n  <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z\" />\n    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n  </svg>\n);\n\nconst CloseIcon = () => (\n  <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n  </svg>\n);\n\nconst ChevronDownIcon = ({ isOpen }: { isOpen: boolean }) => (\n  <svg className={cn('w-4 h-4 transition-transform duration-200', isOpen && 'rotate-180')} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n  </svg>\n);\n\nexport const SignatureSettingsPanel: React.FC<SignatureSettingsPanelProps> = ({\n  options,\n  onOptionsChange,\n  onClose,\n  theme = 'default',\n  className\n}) => {\n  const [showAdvanced, setShowAdvanced] = useState(false);\n\n  const handleChange = (key: keyof SignatureOptions, value: any) => {\n    onOptionsChange({ [key]: value });\n  };\n\n  const handleReset = () => {\n    onOptionsChange({\n      penColor: '#000000',\n      penWidth: 2,\n      backgroundColor: '#ffffff',\n      drawingMode: 'pen',\n      minWidth: 0.5,\n      maxWidth: 2.5,\n      velocityFilterWeight: 0.7\n    });\n  };\n\n  const panelClasses = cn(\n    'w-80 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl shadow-xl p-6',\n    themeClass(theme, '', 'backdrop-blur-sm bg-white/95 dark:bg-gray-900/95'),\n    className\n  );\n\n  return (\n    <div className={panelClasses}>\n      {/* Header */}\n      <div className=\"flex items-center justify-between mb-6\">\n        <div className=\"flex items-center gap-2\">\n          <SettingsIcon />\n          <h3 className=\"text-lg font-semibold text-gray-900 dark:text-gray-100\">\n            Signature Settings\n          </h3>\n        </div>\n        <Button\n          onClick={onClose}\n          variant=\"ghost\"\n          size=\"sm\"\n          icon={<CloseIcon />}\n          aria-label=\"Close settings\"\n        />\n      </div>\n\n      <div className=\"space-y-6\">\n        {/* Basic Settings */}\n        <div className=\"space-y-4\">\n          <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wide\">\n            Basic Settings\n          </h4>\n\n          <div className=\"space-y-4\">\n            <Select\n              label=\"Drawing Mode\"\n              value={options.drawingMode || 'pen'}\n              onChange={(value) => handleChange('drawingMode', value as DrawingMode)}\n              options={drawingModeOptions}\n            />\n\n            <ColorPicker\n              label=\"Pen Color\"\n              value={options.penColor || '#000000'}\n              onChange={(color) => handleChange('penColor', color)}\n            />\n\n            <Slider\n              label=\"Pen Width\"\n              value={options.penWidth || 2}\n              onChange={(width) => handleChange('penWidth', width)}\n              min={1}\n              max={10}\n              step={1}\n              unit=\"px\"\n              variant=\"brand\"\n            />\n\n            <ColorPicker\n              label=\"Background Color\"\n              value={options.backgroundColor || '#ffffff'}\n              onChange={(color) => handleChange('backgroundColor', color)}\n            />\n          </div>\n        </div>\n\n        {/* Advanced Settings (Collapsible) */}\n        <div className=\"border-t border-gray-200 dark:border-gray-700 pt-4\">\n          <button\n            onClick={() => setShowAdvanced(!showAdvanced)}\n            className=\"flex items-center justify-between w-full text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100 transition-colors\"\n          >\n            <span className=\"uppercase tracking-wide\">Advanced Settings</span>\n            <ChevronDownIcon isOpen={showAdvanced} />\n          </button>\n\n          {showAdvanced && (\n            <div className=\"mt-4 space-y-4 animate-in slide-in-from-top-2 duration-200\">\n              <Slider\n                label=\"Minimum Width\"\n                value={options.minWidth || 0.5}\n                onChange={(width) => handleChange('minWidth', width)}\n                min={0.1}\n                max={5}\n                step={0.1}\n                unit=\"px\"\n                variant=\"brand\"\n              />\n\n              <Slider\n                label=\"Maximum Width\"\n                value={options.maxWidth || 2.5}\n                onChange={(width) => handleChange('maxWidth', width)}\n                min={1}\n                max={10}\n                step={0.1}\n                unit=\"px\"\n                variant=\"brand\"\n              />\n\n              <Slider\n                label=\"Velocity Sensitivity\"\n                value={options.velocityFilterWeight || 0.7}\n                onChange={(weight) => handleChange('velocityFilterWeight', weight)}\n                min={0.1}\n                max={1}\n                step={0.1}\n                variant=\"brand\"\n              />\n\n              <div className=\"text-xs text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-gray-800 p-3 rounded-lg\">\n                <strong>Velocity Sensitivity:</strong> Controls how pen speed affects line thickness. \n                Higher values make faster strokes thinner.\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Actions */}\n        <div className=\"flex items-center justify-between pt-4 border-t border-gray-200 dark:border-gray-700\">\n          <Button\n            onClick={handleReset}\n            variant=\"ghost\"\n            size=\"sm\"\n          >\n            Reset to Default\n          </Button>\n          \n          <Button\n            onClick={onClose}\n            variant=\"primary\"\n            size=\"sm\"\n          >\n            Done\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n};","import { Point } from '../types';\n\nexport const drawCurve = (ctx: CanvasRenderingContext2D, points: Point[]): void => {\n  if (points.length < 3) {\n    const point = points[0];\n    ctx.lineTo(point.x, point.y);\n    ctx.stroke();\n    return;\n  }\n\n  ctx.beginPath();\n  ctx.moveTo(points[0].x, points[0].y);\n\n  for (let i = 1; i < points.length - 2; i++) {\n    const xc = (points[i].x + points[i + 1].x) / 2;\n    const yc = (points[i].y + points[i + 1].y) / 2;\n    ctx.quadraticCurveTo(points[i].x, points[i].y, xc, yc);\n  }\n\n  ctx.quadraticCurveTo(\n    points[points.length - 2].x,\n    points[points.length - 2].y,\n    points[points.length - 1].x,\n    points[points.length - 1].y\n  );\n\n  ctx.stroke();\n};\n\nexport const calculateVelocity = (points: Point[]): number => {\n  if (points.length < 2) return 0;\n\n  const lastPoint = points[points.length - 1];\n  const secondLastPoint = points[points.length - 2];\n  \n  const distance = Math.sqrt(\n    Math.pow(lastPoint.x - secondLastPoint.x, 2) + \n    Math.pow(lastPoint.y - secondLastPoint.y, 2)\n  );\n  \n  const timeDiff = lastPoint.time - secondLastPoint.time;\n  \n  return timeDiff > 0 ? distance / timeDiff : 0;\n};\n\nexport const getPressureBasedWidth = (\n  pressure: number, \n  minWidth: number, \n  maxWidth: number\n): number => {\n  return minWidth + (maxWidth - minWidth) * pressure;\n};\n\nexport const getVelocityBasedWidth = (\n  velocity: number, \n  baseWidth: number, \n  minWidth: number, \n  maxWidth: number\n): number => {\n  const newWidth = baseWidth - (velocity * baseWidth) / 5;\n  return Math.max(minWidth, Math.min(maxWidth, newWidth));\n};","import validate from './validate.js';\nconst byteToHex = [];\nfor (let i = 0; i < 256; ++i) {\n    byteToHex.push((i + 0x100).toString(16).slice(1));\n}\nexport function unsafeStringify(arr, offset = 0) {\n    return (byteToHex[arr[offset + 0]] +\n        byteToHex[arr[offset + 1]] +\n        byteToHex[arr[offset + 2]] +\n        byteToHex[arr[offset + 3]] +\n        '-' +\n        byteToHex[arr[offset + 4]] +\n        byteToHex[arr[offset + 5]] +\n        '-' +\n        byteToHex[arr[offset + 6]] +\n        byteToHex[arr[offset + 7]] +\n        '-' +\n        byteToHex[arr[offset + 8]] +\n        byteToHex[arr[offset + 9]] +\n        '-' +\n        byteToHex[arr[offset + 10]] +\n        byteToHex[arr[offset + 11]] +\n        byteToHex[arr[offset + 12]] +\n        byteToHex[arr[offset + 13]] +\n        byteToHex[arr[offset + 14]] +\n        byteToHex[arr[offset + 15]]).toLowerCase();\n}\nfunction stringify(arr, offset = 0) {\n    const uuid = unsafeStringify(arr, offset);\n    if (!validate(uuid)) {\n        throw TypeError('Stringified UUID is invalid');\n    }\n    return uuid;\n}\nexport default stringify;\n","let getRandomValues;\nconst rnds8 = new Uint8Array(16);\nexport default function rng() {\n    if (!getRandomValues) {\n        if (typeof crypto === 'undefined' || !crypto.getRandomValues) {\n            throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n        }\n        getRandomValues = crypto.getRandomValues.bind(crypto);\n    }\n    return getRandomValues(rnds8);\n}\n","const randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nexport default { randomUUID };\n","import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\nfunction _v4(options, buf, offset) {\n    options = options || {};\n    const rnds = options.random ?? options.rng?.() ?? rng();\n    if (rnds.length < 16) {\n        throw new Error('Random bytes length must be >= 16');\n    }\n    rnds[6] = (rnds[6] & 0x0f) | 0x40;\n    rnds[8] = (rnds[8] & 0x3f) | 0x80;\n    if (buf) {\n        offset = offset || 0;\n        if (offset < 0 || offset + 16 > buf.length) {\n            throw new RangeError(`UUID byte range ${offset}:${offset + 15} is out of buffer bounds`);\n        }\n        for (let i = 0; i < 16; ++i) {\n            buf[offset + i] = rnds[i];\n        }\n        return buf;\n    }\n    return unsafeStringify(rnds);\n}\nfunction v4(options, buf, offset) {\n    if (native.randomUUID && !buf && !options) {\n        return native.randomUUID();\n    }\n    return _v4(options, buf, offset);\n}\nexport default v4;\n","import { useRef, useCallback, useEffect, useState } from 'react';\nimport { \n  Point, \n  SignatureOptions, \n  DrawingMode, \n  UseSignatureResult,\n  Stroke,\n  StrokePoint,\n  StrokeStyleSnapshot,\n  SerializedStroke\n} from '../types';\nimport { drawCurve, calculateVelocity } from '../utils/drawingUtils';\nimport { v4 as uuid } from 'uuid';\n\nexport const useSignature = (\n  canvasRef: React.RefObject<HTMLCanvasElement>, \n  options: Partial<SignatureOptions>\n): UseSignatureResult => {\n  const pointsRef = useRef<StrokePoint[]>([]);\n  const currentStrokeRef = useRef<Stroke | null>(null);\n  const strokesRef = useRef<Stroke[]>([]); // committed strokes\n  const redoStackRef = useRef<Stroke[]>([]);\n  const [isEmpty, setIsEmpty] = useState(true);\n  const [currentOptions, setCurrentOptions] = useState<SignatureOptions>({\n    width: options.width || 800,\n    height: options.height || 300,\n    penColor: options.penColor || '#000000',\n    penWidth: options.penWidth || 2,\n    backgroundColor: options.backgroundColor || '#ffffff',\n    drawingMode: options.drawingMode || 'pen',\n    minWidth: options.minWidth || 0.5,\n    maxWidth: options.maxWidth || 2.5,\n    velocityFilterWeight: options.velocityFilterWeight || 0.7,\n  });\n\n  // Update options when they actually change (avoid identity churn causing re-renders)\n  const prevOptionsRef = useRef<Partial<SignatureOptions> | null>(null);\n  useEffect(() => {\n    const keys: (keyof SignatureOptions)[] = [\n      'width','height','penColor','penWidth','backgroundColor','drawingMode','minWidth','maxWidth','velocityFilterWeight'\n    ];\n    let changed = false;\n    const prev = prevOptionsRef.current || {};\n    for (const k of keys) {\n      if (options[k] !== undefined && options[k] !== prev[k]) {\n        changed = true; break;\n      }\n    }\n    if (changed) {\n      setCurrentOptions(prevState => ({\n        ...prevState,\n        ...options,\n        width: options.width || prevState.width,\n        height: options.height || prevState.height,\n      }));\n      prevOptionsRef.current = options;\n    }\n  }, [options]);\n\n  // Initialize canvas\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    \n    const ctx = canvas.getContext('2d');\n    if (!ctx) return;\n    \n    // Set initial styles\n    ctx.lineCap = 'round';\n    ctx.lineJoin = 'round';\n    ctx.fillStyle = currentOptions.backgroundColor;\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n    \n    setIsEmpty(true);\n  }, [canvasRef, currentOptions.backgroundColor]);\n\n  const commitCurrentStroke = useCallback(() => {\n    if (currentStrokeRef.current && currentStrokeRef.current.points.length > 1) {\n      const stroke = currentStrokeRef.current;\n      // compute bounding box\n      let minX = stroke.points[0].x, minY = stroke.points[0].y, maxX = stroke.points[0].x, maxY = stroke.points[0].y;\n      for (const p of stroke.points) {\n        if (p.x < minX) minX = p.x; if (p.y < minY) minY = p.y; if (p.x > maxX) maxX = p.x; if (p.y > maxY) maxY = p.y;\n      }\n      stroke.boundingBox = { minX, minY, maxX, maxY };\n      strokesRef.current.push(stroke);\n      redoStackRef.current = []; // invalidates redo history after new draw\n    }\n    currentStrokeRef.current = null;\n  }, []);\n\n  const redrawAll = useCallback(() => {\n    const canvas = canvasRef.current; if (!canvas) return; const ctx = canvas.getContext('2d'); if (!ctx) return;\n    ctx.clearRect(0,0,canvas.width,canvas.height);\n    ctx.fillStyle = currentOptions.backgroundColor; ctx.fillRect(0,0,canvas.width,canvas.height);\n    for (const stroke of strokesRef.current) {\n      if (stroke.points.length < 2) continue;\n      ctx.save();\n      if (stroke.style.drawingMode === 'highlighter') ctx.globalAlpha = stroke.style.alpha ?? 0.5;\n      ctx.strokeStyle = stroke.style.penColor;\n      ctx.lineWidth = stroke.style.penWidth; // will be dynamically altered inside drawCurve path logic if needed\n      drawCurve(ctx, stroke.points as Point[]);\n      ctx.restore();\n    }\n    setIsEmpty(strokesRef.current.length === 0);\n  }, [canvasRef, currentOptions.backgroundColor]);\n\n  const draw = {\n    start: useCallback((event: MouseEvent | TouchEvent) => {\n      const canvas = canvasRef.current; if (!canvas) return;\n      const ctx = canvas.getContext('2d'); if (!ctx) return;\n      const rect = canvas.getBoundingClientRect();\n      const clientX = 'touches' in event ? event.touches[0].clientX : event.clientX;\n      const clientY = 'touches' in event ? event.touches[0].clientY : event.clientY;\n      const point: StrokePoint = { x: clientX - rect.left, y: clientY - rect.top, time: Date.now(), pressure: 'pressure' in event ? (event as any).pressure : 0.5 };\n      pointsRef.current = [point];\n      const style: StrokeStyleSnapshot = {\n        penColor: currentOptions.penColor,\n        penWidth: currentOptions.penWidth,\n        drawingMode: currentOptions.drawingMode,\n        minWidth: currentOptions.minWidth,\n        maxWidth: currentOptions.maxWidth,\n        velocityFilterWeight: currentOptions.velocityFilterWeight,\n        alpha: currentOptions.drawingMode === 'highlighter' ? 0.5 : 1\n      };\n      currentStrokeRef.current = { id: uuid(), points: [point], style, startedAt: Date.now(), endedAt: Date.now() };\n      setIsEmpty(false);\n      ctx.beginPath();\n      ctx.moveTo(point.x, point.y);\n    }, [canvasRef, currentOptions]),\n    move: useCallback((event: MouseEvent | TouchEvent) => {\n      if (!currentStrokeRef.current) return;\n      const canvas = canvasRef.current; if (!canvas) return; const ctx = canvas.getContext('2d'); if (!ctx) return;\n      const rect = canvas.getBoundingClientRect();\n      const clientX = 'touches' in event ? event.touches[0].clientX : event.clientX;\n      const clientY = 'touches' in event ? event.touches[0].clientY : event.clientY;\n      const newPoint: StrokePoint = { x: clientX - rect.left, y: clientY - rect.top, time: Date.now(), pressure: 'pressure' in event ? (event as any).pressure : 0.5 };\n      pointsRef.current.push(newPoint);\n      currentStrokeRef.current.points.push(newPoint);\n      currentStrokeRef.current.endedAt = newPoint.time;\n      // dynamic width calculation\n      const velocity = calculateVelocity(pointsRef.current);\n      const baseWidth = currentStrokeRef.current.style.penWidth;\n      let width = baseWidth;\n      if (currentStrokeRef.current.style.drawingMode === 'marker') {\n        width = Math.max(currentStrokeRef.current.style.minWidth, baseWidth - (velocity * baseWidth) / 3);\n      } else if (currentStrokeRef.current.style.drawingMode === 'highlighter') {\n        width = baseWidth + 2; ctx.globalAlpha = currentStrokeRef.current.style.alpha ?? 0.5;\n      } else {\n        width = Math.max(currentStrokeRef.current.style.minWidth, Math.min(currentStrokeRef.current.style.maxWidth, baseWidth - (velocity * baseWidth) / 5));\n      }\n      ctx.lineWidth = width; ctx.strokeStyle = currentStrokeRef.current.style.penColor;\n      drawCurve(ctx, pointsRef.current as Point[]);\n      if (currentStrokeRef.current.style.drawingMode === 'highlighter') ctx.globalAlpha = 1;\n      if (pointsRef.current.length > 8) {\n        pointsRef.current = pointsRef.current.slice(-6); // keep small tail for smoothing\n      }\n    }, [canvasRef]),\n    end: useCallback(() => {\n      commitCurrentStroke();\n      pointsRef.current = [];\n    }, [commitCurrentStroke])\n  };\n\n  const clear = useCallback(() => {\n    strokesRef.current = [];\n    redoStackRef.current = [];\n    currentStrokeRef.current = null;\n    const canvas = canvasRef.current; if (!canvas) return; const ctx = canvas.getContext('2d'); if (!ctx) return;\n    ctx.clearRect(0,0,canvas.width,canvas.height);\n    ctx.fillStyle = currentOptions.backgroundColor; ctx.fillRect(0,0,canvas.width,canvas.height);\n    setIsEmpty(true);\n  }, [canvasRef, currentOptions.backgroundColor]);\n\n  const toDataURL = useCallback((type?: string, quality?: number) => {\n    const canvas = canvasRef.current;\n    if (!canvas || isEmpty) return '';\n    return canvas.toDataURL(type, quality);\n  }, [canvasRef, isEmpty]);\n\n  const exportAsImage = useCallback((filename: string = 'signature') => {\n    const dataUrl = toDataURL('image/png');\n    if (!dataUrl) return;\n    \n    const link = document.createElement('a');\n    link.download = `${filename}.png`;\n    link.href = dataUrl;\n    link.click();\n  }, [toDataURL]);\n\n  const exportAsSVG = useCallback(() => {\n    // Build SVG paths from strokes\n    if (!canvasRef.current) return '';\n    const width = canvasRef.current.width;\n    const height = canvasRef.current.height;\n    const pathParts: string[] = [];\n    for (const stroke of strokesRef.current) {\n      if (stroke.points.length < 2) continue;\n      const d: string[] = [];\n      const pts = stroke.points;\n      d.push(`M ${pts[0].x} ${pts[0].y}`);\n      for (let i=1;i<pts.length-2;i++) {\n        const cpx = (pts[i].x + pts[i+1].x)/2;\n        const cpy = (pts[i].y + pts[i+1].y)/2;\n        d.push(`Q ${pts[i].x} ${pts[i].y} ${cpx} ${cpy}`);\n      }\n      const last = pts[pts.length-1];\n      const penultimate = pts[pts.length-2];\n      d.push(`Q ${penultimate.x} ${penultimate.y} ${last.x} ${last.y}`);\n      const opacity = stroke.style.drawingMode === 'highlighter' ? (stroke.style.alpha ?? 0.5) : 1;\n      pathParts.push(`<path d=\"${d.join(' ')}\" fill=\"none\" stroke=\"${stroke.style.penColor}\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"${stroke.style.penWidth}\" stroke-opacity=\"${opacity}\" />`);\n    }\n    return `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${width}\" height=\"${height}\" viewBox=\"0 0 ${width} ${height}\" style=\"background:${currentOptions.backgroundColor}\">${pathParts.join('')}</svg>`;\n  }, [canvasRef, currentOptions.backgroundColor]);\n\n  // Options setters\n  const setDrawingMode = useCallback((mode: DrawingMode) => {\n    setCurrentOptions(prev => ({ ...prev, drawingMode: mode }));\n  }, []);\n\n  const setPenColor = useCallback((color: string) => {\n    setCurrentOptions(prev => ({ ...prev, penColor: color }));\n  }, []);\n\n  const setPenWidth = useCallback((width: number) => {\n    setCurrentOptions(prev => ({ ...prev, penWidth: width }));\n  }, []);\n\n  const setBackgroundColor = useCallback((color: string) => {\n    setCurrentOptions(prev => ({ ...prev, backgroundColor: color }));\n    // Simply redraw all strokes on new background\n    requestAnimationFrame(() => redrawAll());\n  }, [redrawAll]);\n\n  // Undo / Redo\n  const undo = useCallback(() => {\n    commitCurrentStroke();\n    const stroke = strokesRef.current.pop();\n    if (stroke) {\n      redoStackRef.current.push(stroke);\n      redrawAll();\n    }\n  }, [commitCurrentStroke, redrawAll]);\n\n  const redo = useCallback(() => {\n    const stroke = redoStackRef.current.pop();\n    if (stroke) {\n      strokesRef.current.push(stroke);\n      redrawAll();\n    }\n  }, [redrawAll]);\n\n  const canUndo = strokesRef.current.length > 0 || !!currentStrokeRef.current;\n  const canRedo = redoStackRef.current.length > 0;\n\n  const setMinWidth = useCallback((width: number) => {\n    setCurrentOptions(prev => ({ ...prev, minWidth: width }));\n  }, []);\n\n  const setMaxWidth = useCallback((width: number) => {\n    setCurrentOptions(prev => ({ ...prev, maxWidth: width }));\n  }, []);\n\n  const setVelocityFilterWeight = useCallback((weight: number) => {\n    setCurrentOptions(prev => ({ ...prev, velocityFilterWeight: weight }));\n  }, []);\n\n  return {\n    isEmpty,\n    draw,\n    clear,\n    undo,\n    redo,\n    canUndo,\n    canRedo,\n    exportAsImage,\n    exportAsSVG,\n    toDataURL,\n    setDrawingMode,\n    setPenColor,\n    setPenWidth,\n    setBackgroundColor,\n    setMinWidth,\n    setMaxWidth,\n    setVelocityFilterWeight,\n    currentOptions,\n    // New advanced APIs (internal for now; will be documented with imperative handle)\n    getStrokes: () => strokesRef.current.slice(),\n    loadStrokes: (serialized: SerializedStroke[]) => {\n      strokesRef.current = serialized.map(s => ({\n        ...s,\n        points: s.points.map(p => ({ ...p })),\n        style: { ...s.style },\n        boundingBox: undefined // will be recomputed on redraw if needed\n      }));\n      redoStackRef.current = [];\n      redrawAll();\n    }\n  };\n};","import { useState, useCallback } from 'react';\nimport { UseUndoRedoResult } from '../types';\n\nexport const useUndoRedo = (getCurrentState: () => string): UseUndoRedoResult => {\n  const [history, setHistory] = useState<string[]>([]);\n  const [future, setFuture] = useState<string[]>([]);\n  const [maxHistorySize] = useState(50);\n\n  const addState = useCallback((state: string) => {\n    setHistory(prev => {\n      const newHistory = [...prev, state];\n      // Limit history size\n      return newHistory.slice(-maxHistorySize);\n    });\n    setFuture([]); // Clear future when adding a new state\n  }, [maxHistorySize]);\n\n  const undo = useCallback((): string | undefined => {\n    if (history.length === 0) return undefined;\n    \n    const previousState = history[history.length - 1];\n    const currentState = getCurrentState();\n    \n    setHistory(prev => prev.slice(0, -1));\n    setFuture(prev => [currentState, ...prev]);\n    \n    return previousState;\n  }, [history, getCurrentState]);\n\n  const redo = useCallback((): string | undefined => {\n    if (future.length === 0) return undefined;\n    \n    const nextState = future[0];\n    \n    setHistory(prev => [...prev, getCurrentState()]);\n    setFuture(prev => prev.slice(1));\n    \n    return nextState;\n  }, [future, getCurrentState]);\n\n  const clearHistory = useCallback((): void => {\n    setHistory([]);\n    setFuture([]);\n  }, []);\n\n  return {\n    addState,\n    undo,\n    redo,\n    canUndo: history.length > 0,\n    canRedo: future.length > 0,\n    clearHistory\n  };\n};","import { useCallback, useEffect, useState } from 'react';\nimport { useSignature } from './useSignature';\nimport { useUndoRedo } from './useUndoRedo';\nimport { SignatureOptions } from '../types';\n\nexport interface UseSignaturePadOptions extends Partial<SignatureOptions> {\n  maxHistorySize?: number;\n  autoSave?: boolean;\n  autoSaveDelay?: number;\n}\n\nexport interface UseSignaturePadResult {\n  // Canvas operations\n  canvas: {\n    ref: React.RefObject<HTMLCanvasElement>;\n    isEmpty: boolean;\n    isDrawing: boolean;\n    draw: {\n      start: (event: MouseEvent | TouchEvent) => void;\n      move: (event: MouseEvent | TouchEvent) => void;\n      end: () => void;\n    };\n    clear: () => void;\n    resize: () => void;\n  };\n  \n  // History management\n  history: {\n    undo: () => void;\n    redo: () => void;\n    canUndo: boolean;\n    canRedo: boolean;\n    clearHistory: () => void;\n    addCheckpoint: () => void;\n  };\n  \n  // Export capabilities\n  export: {\n    toDataURL: (type?: string, quality?: number) => string;\n    toBlob: () => Promise<Blob | null>;\n    exportAsImage: (filename?: string) => void;\n    exportAsSVG: () => string;\n  };\n  \n  // Settings management\n  settings: {\n    current: SignatureOptions;\n    update: (options: Partial<SignatureOptions>) => void;\n    reset: () => void;\n    penColor: string;\n    penWidth: number;\n    backgroundColor: string;\n    drawingMode: SignatureOptions['drawingMode'];\n    setPenColor: (color: string) => void;\n    setPenWidth: (width: number) => void;\n    setBackgroundColor: (color: string) => void;\n    setDrawingMode: (mode: SignatureOptions['drawingMode']) => void;\n  };\n  \n  // State management\n  state: {\n    loading: boolean;\n    error: string | null;\n    hasChanges: boolean;\n  };\n  \n  // Event handlers\n  events: {\n    onSave?: (dataUrl: string) => Promise<void> | void;\n    onChange?: (isEmpty: boolean) => void;\n    onError?: (error: Error) => void;\n  };\n\n  // Advanced stroke persistence (pass-through from useSignature)\n  getStrokes?: () => any[]; // Array<Stroke> but keep loose here to avoid circular import in lite interface\n  loadStrokes?: (strokes: any[]) => void; // Array<SerializedStroke>\n}\n\nexport function useSignaturePad(\n  canvasRef: React.RefObject<HTMLCanvasElement>,\n  options: UseSignaturePadOptions = {},\n  callbacks: {\n    onSave?: (dataUrl: string) => Promise<void> | void;\n    onChange?: (isEmpty: boolean) => void;\n    onError?: (error: Error) => void;\n  } = {}\n): UseSignaturePadResult {\n  const [isDrawing, setIsDrawing] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [hasChanges, setHasChanges] = useState(false);\n  const [initialOptions] = useState(options);\n\n  // Initialize signature hook\n  const signature = useSignature(canvasRef, options);\n  \n  // Initialize history hook\n  const history = useUndoRedo(\n    () => signature.toDataURL('image/png')\n  );\n\n  // Handle errors\n  const handleError = useCallback((err: Error) => {\n    setError(err.message);\n    callbacks.onError?.(err);\n  }, [callbacks]);\n\n  // Clear error\n  const clearError = useCallback(() => setError(null), []);\n\n  // Enhanced draw handlers with error handling\n  const enhancedDraw = {\n    start: useCallback((event: MouseEvent | TouchEvent) => {\n      try {\n        clearError();\n        setIsDrawing(true);\n        signature.draw.start(event);\n      } catch (err) {\n        handleError(err as Error);\n      }\n    }, [signature.draw, clearError, handleError]),\n\n    move: useCallback((event: MouseEvent | TouchEvent) => {\n      if (!isDrawing) return;\n      try {\n        signature.draw.move(event);\n      } catch (err) {\n        handleError(err as Error);\n      }\n    }, [isDrawing, signature.draw, handleError]),\n\n    end: useCallback(() => {\n      try {\n        setIsDrawing(false);\n        signature.draw.end();\n        setHasChanges(true);\n        // Add to history after drawing ends\n        setTimeout(() => {\n          history.addState(signature.toDataURL('image/png'));\n        }, 100);\n      } catch (err) {\n        handleError(err as Error);\n      }\n    }, [signature.draw, signature.toDataURL, history.addState, handleError])\n  };\n\n  // Enhanced export with loading states\n  const enhancedExport = {\n    toDataURL: signature.toDataURL,\n    \n    toBlob: useCallback(async (): Promise<Blob | null> => {\n      return new Promise((resolve) => {\n        if (!canvasRef.current) {\n          resolve(null);\n          return;\n        }\n        canvasRef.current.toBlob(resolve, 'image/png');\n      });\n    }, [canvasRef]),\n\n    exportAsImage: useCallback(async (filename = 'signature.png') => {\n      try {\n        setLoading(true);\n        clearError();\n        const dataUrl = signature.toDataURL('image/png');\n        const link = document.createElement('a');\n        link.download = filename;\n        link.href = dataUrl;\n        link.click();\n      } catch (err) {\n        handleError(err as Error);\n      } finally {\n        setLoading(false);\n      }\n    }, [signature.toDataURL, clearError, handleError]),\n\n    exportAsSVG: signature.exportAsSVG\n  };\n\n  // Enhanced settings management\n  const enhancedSettings = {\n    current: signature.currentOptions,\n    \n    update: useCallback((newOptions: Partial<SignatureOptions>) => {\n      try {\n        Object.entries(newOptions).forEach(([key, value]) => {\n          switch (key) {\n            case 'penColor':\n              signature.setPenColor(value as string);\n              break;\n            case 'penWidth':\n              signature.setPenWidth(value as number);\n              break;\n            case 'backgroundColor':\n              signature.setBackgroundColor(value as string);\n              break;\n            case 'drawingMode':\n              signature.setDrawingMode(value as SignatureOptions['drawingMode']);\n              break;\n            case 'minWidth':\n              signature.setMinWidth(value as number);\n              break;\n            case 'maxWidth':\n              signature.setMaxWidth(value as number);\n              break;\n            case 'velocityFilterWeight':\n              signature.setVelocityFilterWeight(value as number);\n              break;\n          }\n        });\n      } catch (err) {\n        handleError(err as Error);\n      }\n    }, [signature, handleError]),\n\n    reset: useCallback(() => {\n      try {\n        enhancedSettings.update(initialOptions);\n      } catch (err) {\n        handleError(err as Error);\n      }\n    }, [initialOptions, handleError]),\n\n    penColor: signature.currentOptions.penColor,\n    penWidth: signature.currentOptions.penWidth,\n    backgroundColor: signature.currentOptions.backgroundColor,\n    drawingMode: signature.currentOptions.drawingMode,\n    setPenColor: signature.setPenColor,\n    setPenWidth: signature.setPenWidth,\n    setBackgroundColor: signature.setBackgroundColor,\n    setDrawingMode: signature.setDrawingMode\n  };\n\n  // Handle canvas resize\n  const handleResize = useCallback(() => {\n    // Implementation for responsive canvas sizing\n    if (canvasRef.current) {\n      const canvas = canvasRef.current;\n      const container = canvas.parentElement;\n      if (container) {\n        const { width, height } = container.getBoundingClientRect();\n        canvas.width = width;\n        canvas.height = height;\n      }\n    }\n  }, [canvasRef]);\n\n  // Enhanced clear with confirmation\n  const enhancedClear = useCallback(() => {\n    try {\n      signature.clear();\n      setHasChanges(false);\n      history.addState(''); // Add empty state to history\n    } catch (err) {\n      handleError(err as Error);\n    }\n  }, [signature, history, handleError]);\n\n  // Enhanced history operations\n  const enhancedHistory = {\n    undo: useCallback(() => {\n      try {\n        const previousState = history.undo();\n        if (previousState) {\n          // Restore canvas state\n          setHasChanges(true);\n        }\n      } catch (err) {\n        handleError(err as Error);\n      }\n    }, [history, handleError]),\n\n    redo: useCallback(() => {\n      try {\n        const nextState = history.redo();\n        if (nextState) {\n          // Restore canvas state\n          setHasChanges(true);\n        }\n      } catch (err) {\n        handleError(err as Error);\n      }\n    }, [history, handleError]),\n\n    canUndo: history.canUndo,\n    canRedo: history.canRedo,\n    clearHistory: history.clearHistory,\n    addCheckpoint: useCallback(() => {\n      history.addState(signature.toDataURL('image/png'));\n    }, [history, signature])\n  };\n\n  // Auto-save functionality\n  useEffect(() => {\n    if (options.autoSave && hasChanges && callbacks.onSave) {\n      const timeoutId = setTimeout(() => {\n        const dataUrl = signature.toDataURL('image/png');\n        callbacks.onSave?.(dataUrl);\n        setHasChanges(false);\n      }, options.autoSaveDelay || 1000);\n      \n      return () => clearTimeout(timeoutId);\n    }\n  }, [hasChanges, options.autoSave, options.autoSaveDelay, callbacks.onSave, signature]);\n\n  // Notify parent of changes\n  useEffect(() => {\n    callbacks.onChange?.(signature.isEmpty);\n  }, [signature.isEmpty, callbacks]);\n\n  return {\n    canvas: {\n      ref: canvasRef,\n      isEmpty: signature.isEmpty,\n      isDrawing,\n      draw: enhancedDraw,\n      clear: enhancedClear,\n      resize: handleResize\n    },\n    \n    history: enhancedHistory,\n    \n    export: enhancedExport,\n    \n    settings: enhancedSettings,\n    \n    state: {\n      loading,\n      error,\n      hasChanges\n    },\n    \n    events: callbacks,\n\n    // Advanced stroke APIs (only if underlying hook supplied them)\n    getStrokes: signature.getStrokes,\n    loadStrokes: signature.loadStrokes\n  };\n}","import React, { useRef, useState, useCallback, forwardRef, useImperativeHandle } from 'react';\nimport { cn, themeClass } from '../../utils/classNames';\nimport { SignatureCanvas } from './SignatureCanvas';\nimport { SignatureToolbar } from './SignatureToolbar';\nimport { SignatureActionBar } from './SignatureActionBar';\nimport { SignatureSettingsPanel } from './SignatureSettingsPanel';\nimport { useSignaturePad } from '../../hooks/useSignaturePad';\nimport { SignatureOptions, DrawingMode } from '../../types';\n\n// New enhanced API with grouped props\nexport interface EnhancedSignaturePadProps {\n  // Canvas configuration\n  canvas?: {\n    maxWidth?: number;\n    maxHeight?: number;\n    placeholder?: React.ReactNode;\n  };\n  \n  // Drawing options\n  drawing?: Partial<SignatureOptions>;\n  \n  // UI configuration\n  ui?: {\n    theme?: 'default' | 'tailwind';\n    showToolbar?: boolean;\n    showActionBar?: boolean;\n    showSettings?: boolean;\n    compactToolbar?: boolean;\n  };\n  \n  // Actions configuration\n  actions?: {\n    save?: {\n      enabled?: boolean;\n      text?: string;\n      callback?: (dataUrl: string) => Promise<void> | void;\n    };\n    upload?: {\n      enabled?: boolean;\n      text?: string;\n      callback?: (dataUrl: string) => Promise<void> | void;\n    };\n    clear?: {\n      enabled?: boolean;\n      text?: string;\n      callback?: () => void;\n    };\n  };\n  \n  // Event callbacks\n  events?: {\n    onChange?: (isEmpty: boolean) => void;\n    onError?: (error: Error) => void;\n    onDrawStart?: () => void;\n    onDrawEnd?: () => void;\n  };\n  \n  // Styling\n  className?: string;\n  \n  // Advanced features\n  features?: {\n    autoSave?: boolean;\n    autoSaveDelay?: number;\n    maxHistorySize?: number;\n    enableKeyboardShortcuts?: boolean;\n  };\n}\n\nexport const EnhancedSignaturePad = forwardRef<any, EnhancedSignaturePadProps>(({ \n  canvas: canvasConfig = {},\n  drawing: drawingOptions = {},\n  ui: uiConfig = {},\n  actions: actionsConfig = {},\n  events: eventsConfig = {},\n  className,\n  features: featuresConfig = {}\n}, ref) => {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const [showSettings, setShowSettings] = useState(false);\n\n  // Default configurations\n  const {\n    maxWidth = 800,\n    maxHeight = 300,\n    placeholder\n  } = canvasConfig;\n\n  const {\n    theme = 'default',\n    showToolbar = true,\n    showActionBar = true,\n    showSettings: showSettingsButton = true,\n    compactToolbar = false\n  } = uiConfig;\n\n  const {\n    save: saveConfig = { enabled: true },\n    upload: uploadConfig = { enabled: false },\n    clear: clearConfig = { enabled: true }\n  } = actionsConfig;\n\n  const {\n    autoSave = false,\n    autoSaveDelay = 1000,\n    enableKeyboardShortcuts = true\n  } = featuresConfig;\n\n  // Initialize the signature pad hook\n  const signaturePad = useSignaturePad(\n    canvasRef,\n    {\n      ...drawingOptions,\n      autoSave,\n      autoSaveDelay\n    },\n    {\n      onSave: saveConfig.callback,\n      onChange: eventsConfig.onChange,\n      onError: eventsConfig.onError\n    }\n  );\n\n  // Imperative handle (exposed to parent ref)\n  useImperativeHandle(ref, () => ({\n    ...signaturePad,\n    // Convenience aliases aligned with SignaturePadHandle naming\n    clear: signaturePad.canvas.clear,\n    undo: signaturePad.history.undo,\n    redo: signaturePad.history.redo,\n    toDataURL: signaturePad.export.toDataURL,\n    toSVG: signaturePad.export.exportAsSVG,\n  }), [signaturePad]);\n\n  // Enhanced event handlers\n  const handleDrawStart = useCallback(() => {\n    eventsConfig.onDrawStart?.();\n  }, [eventsConfig]);\n\n  const handleDrawEnd = useCallback(() => {\n    eventsConfig.onDrawEnd?.();\n  }, [eventsConfig]);\n\n  const handleSave = useCallback(async () => {\n    if (saveConfig.callback) {\n      try {\n        const dataUrl = signaturePad.export.toDataURL('image/png');\n        await saveConfig.callback(dataUrl);\n      } catch (error) {\n        signaturePad.events.onError?.(error as Error);\n      }\n    } else {\n      // Default save behavior\n      signaturePad.export.exportAsImage();\n    }\n  }, [saveConfig, signaturePad]);\n\n  const handleUpload = useCallback(async () => {\n    if (uploadConfig.callback) {\n      try {\n        const dataUrl = signaturePad.export.toDataURL('image/png');\n        await uploadConfig.callback(dataUrl);\n      } catch (error) {\n        signaturePad.events.onError?.(error as Error);\n      }\n    } else {\n      // Default upload behavior\n      signaturePad.export.exportAsImage();\n    }\n  }, [uploadConfig, signaturePad]);\n\n  const handleClear = useCallback(() => {\n    clearConfig.callback?.();\n    signaturePad.canvas.clear();\n  }, [clearConfig, signaturePad]);\n\n  // Keyboard shortcuts\n  React.useEffect(() => {\n    if (!enableKeyboardShortcuts) return;\n\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (e.ctrlKey || e.metaKey) {\n        switch (e.key) {\n          case 'z':\n            if (e.shiftKey) {\n              e.preventDefault();\n              signaturePad.history.redo();\n            } else {\n              e.preventDefault();\n              signaturePad.history.undo();\n            }\n            break;\n          case 'y':\n            e.preventDefault();\n            signaturePad.history.redo();\n            break;\n          case 's':\n            e.preventDefault();\n            if (saveConfig.enabled) {\n              handleSave();\n            }\n            break;\n        }\n      } else if (e.key === 'Escape') {\n        setShowSettings(false);\n      }\n    };\n\n    document.addEventListener('keydown', handleKeyDown);\n    return () => document.removeEventListener('keydown', handleKeyDown);\n  }, [enableKeyboardShortcuts, signaturePad, saveConfig.enabled, handleSave]);\n\n  // Main container classes\n  const containerClasses = cn(\n    'signature-pad-enhanced relative max-w-full mx-auto',\n    themeClass(\n      theme,\n      'bg-white border border-gray-200 rounded-lg shadow-lg p-6',\n      'bg-gradient-to-br from-white via-gray-50 to-white dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 rounded-2xl shadow-2xl shadow-gray-200/50 dark:shadow-gray-900/50 border border-gray-200/60 dark:border-gray-700/60 backdrop-blur-sm p-6'\n    ),\n    className\n  );\n\n  return (\n    <div className={containerClasses} style={{ maxWidth: `${maxWidth + 48}px` }}>\n      {/* Error Display */}\n      {signaturePad.state.error && (\n        <div className=\"mb-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-red-700 dark:text-red-300 text-sm\">\n          <div className=\"flex items-center gap-2\">\n            <svg className=\"w-4 h-4 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n            </svg>\n            <span>{signaturePad.state.error}</span>\n          </div>\n        </div>\n      )}\n\n      {/* Settings Panel */}\n      {showSettings && (\n        <div className=\"absolute top-0 right-0 z-50 mt-2 mr-2\">\n          <SignatureSettingsPanel\n            options={signaturePad.settings.current}\n            onOptionsChange={signaturePad.settings.update}\n            onClose={() => setShowSettings(false)}\n            theme={theme}\n          />\n        </div>\n      )}\n\n      {/* Header with Settings Toggle */}\n      {showSettingsButton && (\n        <div className=\"flex justify-end mb-4\">\n          <button\n            onClick={() => setShowSettings(!showSettings)}\n            className={cn(\n              'inline-flex items-center gap-2 px-3 py-2 text-sm font-medium rounded-lg transition-all duration-200',\n              themeClass(\n                theme,\n                'bg-gray-100 hover:bg-gray-200 text-gray-700 border border-gray-300',\n                'bg-gray-100/80 hover:bg-gray-200/80 dark:bg-gray-800/80 dark:hover:bg-gray-700/80 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 backdrop-blur-sm'\n              ),\n              showSettings && 'bg-brand-100 text-brand-700 border-brand-300'\n            )}\n          >\n            <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z\" />\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n            </svg>\n            {showSettings ? 'Hide Settings' : 'Settings'}\n          </button>\n        </div>\n      )}\n\n      <div className=\"space-y-4\">\n        {/* Drawing Toolbar */}\n        {showToolbar && (\n          <SignatureToolbar\n            currentOptions={signaturePad.settings.current}\n            onPenColorChange={signaturePad.settings.setPenColor}\n            onPenWidthChange={signaturePad.settings.setPenWidth}\n            onDrawingModeChange={signaturePad.settings.setDrawingMode}\n            theme={theme}\n            compact={compactToolbar}\n          />\n        )}\n\n        {/* Signature Canvas */}\n        <SignatureCanvas\n          canvasRef={canvasRef}\n          isEmpty={signaturePad.canvas.isEmpty}\n          isDrawing={signaturePad.canvas.isDrawing}\n          onDrawStart={(e) => {\n            handleDrawStart();\n            signaturePad.canvas.draw.start(e);\n          }}\n          onDrawMove={signaturePad.canvas.draw.move}\n          onDrawEnd={() => {\n            signaturePad.canvas.draw.end();\n            handleDrawEnd();\n          }}\n          maxWidth={maxWidth}\n          maxHeight={maxHeight}\n          theme={theme}\n          placeholder={placeholder}\n          options={signaturePad.settings.current}\n        />\n\n        {/* Action Bar */}\n        {showActionBar && (\n          <SignatureActionBar\n            onUndo={signaturePad.history.undo}\n            onRedo={signaturePad.history.redo}\n            onClear={handleClear}\n            onSave={saveConfig.enabled ? handleSave : undefined}\n            onUpload={uploadConfig.enabled ? handleUpload : undefined}\n            canUndo={signaturePad.history.canUndo}\n            canRedo={signaturePad.history.canRedo}\n            isEmpty={signaturePad.canvas.isEmpty}\n            loading={signaturePad.state.loading}\n            theme={theme}\n            saveText={saveConfig.text}\n            uploadText={uploadConfig.text}\n            clearText={clearConfig.text}\n            showSave={saveConfig.enabled}\n            showUpload={uploadConfig.enabled}\n            showClear={clearConfig.enabled}\n          />\n        )}\n      </div>\n\n      {/* Loading Overlay */}\n      {signaturePad.state.loading && (\n        <div className=\"absolute inset-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-sm rounded-lg flex items-center justify-center z-40\">\n          <div className=\"flex items-center gap-3 text-gray-600 dark:text-gray-400\">\n            <svg className=\"w-5 h-5 animate-spin\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\" />\n            </svg>\n            <span>Processing...</span>\n          </div>\n        </div>\n      )}\n\n      {/* Keyboard Shortcuts Help */}\n      {enableKeyboardShortcuts && (\n        <div className=\"mt-4 text-xs text-gray-500 dark:text-gray-400 text-center\">\n          <kbd className=\"px-1 py-0.5 bg-gray-100 dark:bg-gray-800 rounded\">Ctrl+Z</kbd> Undo  \n          <kbd className=\"px-1 py-0.5 bg-gray-100 dark:bg-gray-800 rounded ml-1\">Ctrl+Y</kbd> Redo  \n          <kbd className=\"px-1 py-0.5 bg-gray-100 dark:bg-gray-800 rounded ml-1\">Ctrl+S</kbd> Save\n        </div>\n      )}\n    </div>\n  );\n});\n\n// Display name for devtools\nEnhancedSignaturePad.displayName = 'EnhancedSignaturePad';","import React, { forwardRef, useImperativeHandle, useRef } from 'react';\nimport { SignaturePadProps, SignaturePadHandle } from '../types';\nimport { EnhancedSignaturePad, EnhancedSignaturePadProps } from './SignaturePad/EnhancedSignaturePad';\n\n// Enhanced version with backward compatibility wrapper\nconst SignaturePad = forwardRef<SignaturePadHandle, SignaturePadProps>((props, ref) => {\n  // We will attempt to capture internal imperative functions via a ref to the enhanced component if it exposes them later.\n  const internalRef = useRef<any>(null);\n  useImperativeHandle(ref, () => ({\n    clear: () => internalRef.current?.canvas?.clear?.() || internalRef.current?.clear?.(),\n    undo: () => internalRef.current?.history?.undo?.(),\n    redo: () => internalRef.current?.history?.redo?.(),\n    toDataURL: (type?: string, quality?: number) => internalRef.current?.export?.toDataURL?.(type, quality) || '',\n    toSVG: () => internalRef.current?.export?.exportAsSVG?.() || internalRef.current?.exportAsSVG?.() || '',\n    getStrokes: () => internalRef.current?.getStrokes?.() || [],\n    loadStrokes: (s) => internalRef.current?.loadStrokes?.(s)\n  }), []);\n  // If using new enhanced API pattern, delegate to EnhancedSignaturePad\n  if ('canvas' in props || 'drawing' in props || 'ui' in props || 'actions' in props) {\n  return <EnhancedSignaturePad ref={internalRef} {...props as any} />;\n  }\n\n  // Legacy API support - convert old props to new format\n  const {\n    onSave,\n    onUpload,\n    onClear,\n    onChange,\n    options = {},\n    className = '',\n    showControls = true,\n    showCustomization = true,\n    uploadButton = false,\n    uploadText = \"Upload Signature\",\n    saveButton = true,\n    saveText = \"Save Signature\",\n    clearButton = true,\n    clearText = \"Clear\",\n    maxWidth = 800,\n    maxHeight = 300,\n    theme = 'default',\n    showDarkModeToggle = false,\n  } = props;\n\n  // Convert legacy props to new enhanced API format\n  const enhancedProps: EnhancedSignaturePadProps = {\n    className,\n    canvas: {\n      maxWidth,\n      maxHeight\n    },\n    drawing: options,\n    ui: {\n      theme,\n      showToolbar: showControls,\n      showActionBar: showControls,\n      showSettings: showCustomization\n    },\n    actions: {\n      save: {\n        enabled: saveButton,\n        text: saveText,\n        callback: onSave\n      },\n      upload: {\n        enabled: uploadButton,\n        text: uploadText,\n        callback: onUpload\n      },\n      clear: {\n        enabled: clearButton,\n        text: clearText,\n        callback: onClear\n      }\n    },\n    events: {\n      onChange\n    },\n    features: {\n      enableKeyboardShortcuts: true\n    }\n  };\n\n  return <EnhancedSignaturePad ref={internalRef} {...enhancedProps} />;\n});\n\nexport default SignaturePad;","export const dataURLToBlob = (dataURL: string): Blob => {\n  const parts = dataURL.split(';base64,');\n  const contentType = parts[0].split(':')[1];\n  const raw = window.atob(parts[1]);\n  const uInt8Array = new Uint8Array(raw.length);\n  \n  for (let i = 0; i < raw.length; ++i) {\n    uInt8Array[i] = raw.charCodeAt(i);\n  }\n  \n  return new Blob([uInt8Array], { type: contentType });\n};\n\nexport const downloadDataURL = (dataURL: string, filename: string): void => {\n  const link = document.createElement('a');\n  link.download = filename;\n  link.href = dataURL;\n  link.click();\n};\n\nexport const dataURLToFile = (dataURL: string, filename: string): File => {\n  const blob = dataURLToBlob(dataURL);\n  return new File([blob], filename, { type: blob.type });\n};\n\nexport const uploadDataURL = async (\n  dataURL: string, \n  url: string, \n  fieldName: string = 'signature'\n): Promise<Response> => {\n  const formData = new FormData();\n  const file = dataURLToFile(dataURL, 'signature.png');\n  formData.append(fieldName, file);\n  \n  return fetch(url, {\n    method: 'POST',\n    body: formData\n  });\n};","import { Point } from '../types';\n\nexport const validateSignature = (points: Point[]): boolean => {\n  if (points.length < 5) return false;\n  \n  // Check if signature has enough complexity\n  const boundingBox = getBoundingBox(points);\n  const area = (boundingBox.maxX - boundingBox.minX) * (boundingBox.maxY - boundingBox.minY);\n  \n  if (area < 100) return false; // Too small\n  \n  // Check if signature has enough movement\n  const totalDistance = calculateTotalDistance(points);\n  if (totalDistance < 50) return false; // Not enough movement\n  \n  return true;\n};\n\nexport const getBoundingBox = (points: Point[]): { minX: number; minY: number; maxX: number; maxY: number } => {\n  if (points.length === 0) return { minX: 0, minY: 0, maxX: 0, maxY: 0 };\n  \n  let minX = points[0].x;\n  let minY = points[0].y;\n  let maxX = points[0].x;\n  let maxY = points[0].y;\n  \n  for (let i = 1; i < points.length; i++) {\n    minX = Math.min(minX, points[i].x);\n    minY = Math.min(minY, points[i].y);\n    maxX = Math.max(maxX, points[i].x);\n    maxY = Math.max(maxY, points[i].y);\n  }\n  \n  return { minX, minY, maxX, maxY };\n};\n\nexport const calculateTotalDistance = (points: Point[]): number => {\n  let distance = 0;\n  \n  for (let i = 1; i < points.length; i++) {\n    distance += Math.sqrt(\n      Math.pow(points[i].x - points[i - 1].x, 2) + \n      Math.pow(points[i].y - points[i - 1].y, 2)\n    );\n  }\n  \n  return distance;\n};\n\nexport const isSignatureEmpty = (dataURL: string): boolean => {\n  // Create a canvas to check if the signature is empty\n  const canvas = document.createElement('canvas');\n  const ctx = canvas.getContext('2d');\n  \n  if (!ctx) return true;\n  \n  const img = new Image();\n  img.src = dataURL;\n  \n  // This is a simplified check - in a real implementation, you'd need to wait for the image to load\n  // and then check if it has any non-transparent pixels\n  \n  return dataURL === '' || dataURL.includes('data:image/png;base64,AAAA');\n};"],"names":["cn","inputs","filter","Boolean","join","themeClass","theme","defaultClass","tailwindClass","defaultPlaceholder","React","createElement","className","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","SignatureCanvas","canvasRef","isEmpty","isDrawing","onDrawStart","onDrawMove","onDrawEnd","maxWidth","maxHeight","placeholder","options","containerRef","useRef","useEffect","resizeCanvas","current","containerWidth","clientWidth","width","Math","min","height","canvas","ctx","getContext","imageData","getImageData","putImageData","backgroundColor","fillStyle","fillRect","window","addEventListener","removeEventListener","handleTouchEnd","e","preventDefault","containerClasses","canvasClasses","ref","style","onMouseDown","nativeEvent","onMouseMove","onMouseUp","onMouseLeave","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel","role","id","Select","value","onChange","label","error","disabled","props","target","hidden","map","option","key","Slider","max","step","showValue","unit","variant","type","Number","drawingModeOptions","SignatureToolbar","currentOptions","onPenColorChange","onPenWidthChange","onDrawingModeChange","compact","drawingMode","penColor","title","penWidth","opacity","buttonVariants","primary","secondary","tertiary","danger","ghost","buttonSizes","sm","md","lg","Button","size","loading","icon","iconPosition","children","isDisabled","cx","cy","r","UndoIcon","RedoIcon","ClearIcon","SaveIcon","UploadIcon","SignatureActionBar","onUndo","onRedo","onClear","onSave","onUpload","canUndo","canRedo","saveText","uploadText","clearText","showSave","showUpload","showClear","onClick","ColorPicker","presets","toUpperCase","color","test","SettingsIcon","CloseIcon","ChevronDownIcon","isOpen","SignatureSettingsPanel","onOptionsChange","onClose","showAdvanced","setShowAdvanced","useState","handleChange","panelClasses","minWidth","velocityFilterWeight","weight","drawCurve","points","length","point","lineTo","x","y","beginPath","moveTo","i","xc","yc","quadraticCurveTo","byteToHex","push","toString","slice","getRandomValues","rnds8","Uint8Array","native","randomUUID","crypto","bind","_v4","buf","offset","rnds","random","rng","Error","RangeError","arr","toLowerCase","unsafeStringify","v4","useSignature","pointsRef","currentStrokeRef","strokesRef","redoStackRef","setIsEmpty","setCurrentOptions","prevOptionsRef","keys","changed","prev","k","undefined","prevState","lineCap","lineJoin","commitCurrentStroke","useCallback","minX","minY","maxX","maxY","p","boundingBox","redrawAll","clearRect","save","globalAlpha","_a","alpha","strokeStyle","lineWidth","restore","draw","start","event","rect","getBoundingClientRect","clientX","touches","clientY","left","top","time","Date","now","pressure","uuid","startedAt","endedAt","move","newPoint","velocity","lastPoint","secondLastPoint","distance","sqrt","pow","timeDiff","calculateVelocity","baseWidth","end","clear","toDataURL","quality","exportAsImage","filename","dataUrl","link","document","download","href","click","exportAsSVG","pathParts","pts","cpx","cpy","last","penultimate","setDrawingMode","mode","setPenColor","setPenWidth","setBackgroundColor","requestAnimationFrame","undo","pop","redo","setMinWidth","setMaxWidth","setVelocityFilterWeight","getStrokes","loadStrokes","serialized","s","useUndoRedo","getCurrentState","history","setHistory","future","setFuture","maxHistorySize","addState","state","previousState","currentState","nextState","clearHistory","useSignaturePad","callbacks","setIsDrawing","setLoading","setError","hasChanges","setHasChanges","initialOptions","signature","handleError","err","message","onError","call","clearError","enhancedDraw","setTimeout","enhancedExport","toBlob","async","Promise","resolve","enhancedSettings","update","newOptions","Object","entries","forEach","reset","handleResize","container","parentElement","enhancedClear","enhancedHistory","addCheckpoint","autoSave","timeoutId","autoSaveDelay","clearTimeout","resize","export","settings","events","EnhancedSignaturePad","forwardRef","canvasConfig","drawing","drawingOptions","ui","uiConfig","actions","actionsConfig","eventsConfig","features","featuresConfig","showSettings","setShowSettings","showToolbar","showActionBar","showSettingsButton","compactToolbar","saveConfig","enabled","upload","uploadConfig","clearConfig","enableKeyboardShortcuts","signaturePad","callback","useImperativeHandle","toSVG","handleDrawStart","handleDrawEnd","handleSave","_b","handleUpload","handleClear","handleKeyDown","ctrlKey","metaKey","shiftKey","text","displayName","SignaturePad","internalRef","_c","_d","_e","showControls","showCustomization","uploadButton","saveButton","clearButton","showDarkModeToggle","enhancedProps","dataURLToBlob","dataURL","parts","split","contentType","raw","atob","uInt8Array","charCodeAt","Blob","dataURLToFile","blob","File","getBoundingBox","calculateTotalDistance","condition","trueClass","falseClass","Image","src","includes","url","fieldName","formData","FormData","file","append","fetch","method","body"],"mappings":"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","x_google_ignoreList":[10,11,12,13]}